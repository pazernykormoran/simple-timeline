/*

 Underscore.js 1.1.4
 (c) 2011 Jeremy Ashkenas, DocumentCloud Inc.
 Underscore is freely distributable under the MIT license.
 Portions of Underscore are inspired or borrowed from Prototype,
 Oliver Steele's Functional, and John Resig's Micro-Templating.
 For all details and documentation:
 http://documentcloud.github.com/underscore
*/
(function(){var h=this,B=h._,r={},j=Array.prototype,A=Object.prototype,c=j.slice,n=j.unshift,z=A.toString,d=A.hasOwnProperty,w=j.forEach,g=j.map,N=j.reduce,J=j.reduceRight,K=j.filter,f=j.every,l=j.some,q=j.indexOf,D=j.lastIndexOf,A=Array.isArray,a=Object.keys,e=function(u){return new s(u)};"undefined"!==typeof module&&module.exports?(module.exports=e,e._=e):h._=e;e.VERSION="1.1.4";var H=e.each=e.forEach=function(u,a,k){if(null!=u)if(w&&u.forEach===w)u.forEach(a,k);else if(e.isNumber(u.length))for(var c=
0,f=u.length;c<f&&a.call(k,u[c],c,u)!==r;c++);else for(c in u)if(d.call(u,c)&&a.call(k,u[c],c,u)===r)break};e.map=function(u,a,e){var k=[];if(null==u)return k;if(g&&u.map===g)return u.map(a,e);H(u,function(u,c,d){k[k.length]=a.call(e,u,c,d)});return k};e.reduce=e.foldl=e.inject=function(u,a,k,c){var d=void 0!==k;null==u&&(u=[]);if(N&&u.reduce===N)return c&&(a=e.bind(a,c)),d?u.reduce(a,k):u.reduce(a);H(u,function(u,e,f){!d&&0===e?(k=u,d=!0):k=a.call(c,k,u,e,f)});if(!d)throw new TypeError("Reduce of empty array with no initial value");
return k};e.reduceRight=e.foldr=function(u,a,k,c){null==u&&(u=[]);if(J&&u.reduceRight===J)return c&&(a=e.bind(a,c)),void 0!==k?u.reduceRight(a,k):u.reduceRight(a);u=(e.isArray(u)?u.slice():e.toArray(u)).reverse();return e.reduce(u,a,k,c)};e.find=e.detect=function(u,a,e){var k;L(u,function(u,c,d){if(a.call(e,u,c,d))return k=u,!0});return k};e.filter=e.select=function(u,a,e){var k=[];if(null==u)return k;if(K&&u.filter===K)return u.filter(a,e);H(u,function(u,c,d){a.call(e,u,c,d)&&(k[k.length]=u)});return k};
e.reject=function(u,a,e){var k=[];if(null==u)return k;H(u,function(u,c,d){a.call(e,u,c,d)||(k[k.length]=u)});return k};e.every=e.all=function(u,a,k){a=a||e.identity;var c=!0;if(null==u)return c;if(f&&u.every===f)return u.every(a,k);H(u,function(u,e,d){if(!(c=c&&a.call(k,u,e,d)))return r});return c};var L=e.some=e.any=function(u,a,k){a=a||e.identity;var c=!1;if(null==u)return c;if(l&&u.some===l)return u.some(a,k);H(u,function(u,e,d){if(c=a.call(k,u,e,d))return r});return c};e.include=e.contains=function(a,
e){var k=!1;if(null==a)return k;if(q&&a.indexOf===q)return-1!=a.indexOf(e);L(a,function(a){if(k=a===e)return!0});return k};e.invoke=function(a,k){var d=c.call(arguments,2);return e.map(a,function(a){return(k?a[k]:a).apply(a,d)})};e.pluck=function(a,k){return e.map(a,function(a){return a[k]})};e.max=function(a,k,c){if(!k&&e.isArray(a))return Math.max.apply(Math,a);var d={computed:-Infinity};H(a,function(a,e,u){e=k?k.call(c,a,e,u):a;e>=d.computed&&(d={value:a,computed:e})});return d.value};e.min=function(a,
k,c){if(!k&&e.isArray(a))return Math.min.apply(Math,a);var d={computed:Infinity};H(a,function(a,e,u){e=k?k.call(c,a,e,u):a;e<d.computed&&(d={value:a,computed:e})});return d.value};e.sortBy=function(a,k,c){return e.pluck(e.map(a,function(a,e,u){return{value:a,criteria:k.call(c,a,e,u)}}).sort(function(a,e){var u=a.criteria,k=e.criteria;return u<k?-1:u>k?1:0}),"value")};e.sortedIndex=function(a,k,c){c=c||e.identity;for(var d=0,f=a.length;d<f;){var s=d+f>>1;c(a[s])<c(k)?d=s+1:f=s}return d};e.toArray=
function(a){return!a?[]:a.toArray?a.toArray():e.isArray(a)?a:e.isArguments(a)?c.call(a):e.values(a)};e.size=function(a){return e.toArray(a).length};e.first=e.head=function(a,e,k){return e&&!k?c.call(a,0,e):a[0]};e.rest=e.tail=function(a,k,d){return c.call(a,e.isUndefined(k)||d?1:k)};e.last=function(a){return a[a.length-1]};e.compact=function(a){return e.filter(a,function(a){return!!a})};e.flatten=function(a){return e.reduce(a,function(a,u){if(e.isArray(u))return a.concat(e.flatten(u));a[a.length]=
u;return a},[])};e.without=function(a){var k=c.call(arguments,1);return e.filter(a,function(a){return!e.include(k,a)})};e.uniq=e.unique=function(a,k){return e.reduce(a,function(a,u,c){if(0==c||(!0===k?e.last(a)!=u:!e.include(a,u)))a[a.length]=u;return a},[])};e.intersect=function(a){var k=c.call(arguments,1);return e.filter(e.uniq(a),function(a){return e.every(k,function(u){return 0<=e.indexOf(u,a)})})};e.zip=function(){for(var a=c.call(arguments),k=e.max(e.pluck(a,"length")),d=Array(k),f=0;f<k;f++)d[f]=
e.pluck(a,""+f);return d};e.indexOf=function(a,k,c){if(null==a)return-1;if(c)return c=e.sortedIndex(a,k),a[c]===k?c:-1;if(q&&a.indexOf===q)return a.indexOf(k);c=0;for(var d=a.length;c<d;c++)if(a[c]===k)return c;return-1};e.lastIndexOf=function(a,e){if(null==a)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(e);for(var k=a.length;k--;)if(a[k]===e)return k;return-1};e.range=function(a,e,k){var d=c.call(arguments),f=1>=d.length;a=f?0:d[0];e=f?d[0]:d[1];k=d[2]||1;for(var d=Math.max(Math.ceil((e-
a)/k),0),f=0,s=Array(d);f<d;)s[f++]=a,a+=k;return s};e.bind=function(a,e){var k=c.call(arguments,2);return function(){return a.apply(e||{},k.concat(c.call(arguments)))}};e.bindAll=function(a){var k=c.call(arguments,1);0==k.length&&(k=e.functions(a));H(k,function(k){a[k]=e.bind(a[k],a)});return a};e.memoize=function(a,k){var c={};k=k||e.identity;return function(){var e=k.apply(this,arguments);return e in c?c[e]:c[e]=a.apply(this,arguments)}};e.delay=function(a,e){var k=c.call(arguments,2);return setTimeout(function(){return a.apply(a,
k)},e)};e.defer=function(a){return e.delay.apply(e,[a,1].concat(c.call(arguments,1)))};var x=function(a,e,k){var c;return function(){var d=this,f=arguments,s=function(){c=null;a.apply(d,f)};k&&clearTimeout(c);if(k||!c)c=setTimeout(s,e)}};e.throttle=function(a,e){return x(a,e,!1)};e.debounce=function(a,e){return x(a,e,!0)};e.wrap=function(a,e){return function(){var k=[a].concat(c.call(arguments));return e.apply(this,k)}};e.compose=function(){var a=c.call(arguments);return function(){for(var e=c.call(arguments),
k=a.length-1;0<=k;k--)e=[a[k].apply(this,e)];return e[0]}};e.keys=a||function(a){if(e.isArray(a))return e.range(0,a.length);var k=[],c;for(c in a)d.call(a,c)&&(k[k.length]=c);return k};e.values=function(a){return e.map(a,e.identity)};e.functions=e.methods=function(a){return e.filter(e.keys(a),function(k){return e.isFunction(a[k])}).sort()};e.extend=function(a){H(c.call(arguments,1),function(e){for(var k in e)a[k]=e[k]});return a};e.clone=function(a){return e.isArray(a)?a.slice():e.extend({},a)};e.tap=
function(a,e){e(a);return a};e.isEqual=function(a,k){if(a===k)return!0;var c=typeof a;if(c!=typeof k)return!1;if(a==k)return!0;if(!a&&k||a&&!k)return!1;a._chain&&(a=a._wrapped);k._chain&&(k=k._wrapped);if(a.isEqual)return a.isEqual(k);if(e.isDate(a)&&e.isDate(k))return a.getTime()===k.getTime();if(e.isNaN(a)&&e.isNaN(k))return!1;if(e.isRegExp(a)&&e.isRegExp(k))return a.source===k.source&&a.global===k.global&&a.ignoreCase===k.ignoreCase&&a.multiline===k.multiline;if("object"!==c||a.length&&a.length!==
k.length)return!1;var c=e.keys(a),d=e.keys(k);if(c.length!=d.length)return!1;for(var f in a)if(!(f in k)||!e.isEqual(a[f],k[f]))return!1;return!0};e.isEmpty=function(a){if(e.isArray(a)||e.isString(a))return 0===a.length;for(var k in a)if(d.call(a,k))return!1;return!0};e.isElement=function(a){return!!(a&&1==a.nodeType)};e.isArray=A||function(a){return"[object Array]"===z.call(a)};e.isArguments=function(a){return!(!a||!d.call(a,"callee"))};e.isFunction=function(a){return!(!a||!a.constructor||!a.call||
!a.apply)};e.isString=function(a){return!!(""===a||a&&a.charCodeAt&&a.substr)};e.isNumber=function(a){return!!(0===a||a&&a.toExponential&&a.toFixed)};e.isNaN=function(a){return a!==a};e.isBoolean=function(a){return!0===a||!1===a};e.isDate=function(a){return!(!a||!a.getTimezoneOffset||!a.setUTCFullYear)};e.isRegExp=function(a){return!(!a||!a.test||!a.exec||!(a.ignoreCase||!1===a.ignoreCase))};e.isNull=function(a){return null===a};e.isUndefined=function(a){return void 0===a};e.noConflict=function(){h._=
B;return this};e.identity=function(a){return a};e.times=function(a,e,k){for(var c=0;c<a;c++)e.call(k,c)};e.mixin=function(a){H(e.functions(a),function(k){var d=e[k]=a[k];s.prototype[k]=function(){var a=c.call(arguments);n.call(a,this._wrapped);return y(d.apply(e,a),this._chain)}})};var k=0;e.uniqueId=function(a){var e=k++;return a?a+e:e};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};e.template=function(a,k){var c=e.templateSettings,c="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+
a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.interpolate,function(a,e){return"',"+e.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,e){return"');"+e.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",c=new Function("obj",c);return k?c(k):c};var s=function(a){this._wrapped=a};e.prototype=s.prototype;var y=function(a,k){return k?e(a).chain():a};e.mixin(e);H("pop push reverse shift sort splice unshift".split(" "),
function(a){var e=j[a];s.prototype[a]=function(){e.apply(this._wrapped,arguments);return y(this._wrapped,this._chain)}});H(["concat","join","slice"],function(a){var e=j[a];s.prototype[a]=function(){return y(e.apply(this._wrapped,arguments),this._chain)}});s.prototype.chain=function(){this._chain=!0;return this};s.prototype.value=function(){return this._wrapped}})();(function(){var h=this,B=h.Backbone,r;r="undefined"!==typeof exports?exports:h.Backbone={};r.VERSION="0.5.1";var j=h._;!j&&"undefined"!==typeof require&&(j=require("underscore")._);var A=h.jQuery||h.Zepto;r.noConflict=function(){h.Backbone=B;return this};r.emulateHTTP=!1;r.emulateJSON=!1;r.Events={bind:function(a,e){var c=this._callbacks||(this._callbacks={});(c[a]||(c[a]=[])).push(e);return this},unbind:function(a,e){var c;if(a){if(c=this._callbacks)if(e){c=c[a];if(!c)return this;for(var d=0,f=c.length;d<
f;d++)if(e===c[d]){c[d]=null;break}}else c[a]=[]}else this._callbacks={};return this},trigger:function(a){var e,c,d,f,k=2;if(!(c=this._callbacks))return this;for(;k--;)if(e=k?a:"all",e=c[e])for(var s=0,h=e.length;s<h;s++)(d=e[s])?(f=k?Array.prototype.slice.call(arguments,1):arguments,d.apply(this,f)):(e.splice(s,1),s--,h--);return this}};r.Model=function(a,e){var c;a||(a={});if(c=this.defaults)j.isFunction(c)&&(c=c()),a=j.extend({},c,a);this.attributes={};this._escapedAttributes={};this.cid=j.uniqueId("c");
this.set(a,{silent:!0});this._changed=!1;this._previousAttributes=j.clone(this.attributes);e&&e.collection&&(this.collection=e.collection);this.initialize(a,e)};j.extend(r.Model.prototype,r.Events,{_previousAttributes:null,_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return j.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var e;if(e=this._escapedAttributes[a])return e;e=this.attributes[a];return this._escapedAttributes[a]=(null==e?"":
""+e).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27").replace(/\//g,"&#x2F;")},has:function(a){return null!=this.attributes[a]},set:function(a,e){e||(e={});if(!a)return this;a.attributes&&(a=a.attributes);var c=this.attributes,d=this._escapedAttributes;if(!e.silent&&this.validate&&!this._performValidation(a,e))return!1;this.idAttribute in a&&(this.id=a[this.idAttribute]);var f=this._changing;this._changing=!0;
for(var k in a){var s=a[k];j.isEqual(c[k],s)||(c[k]=s,delete d[k],this._changed=!0,e.silent||this.trigger("change:"+k,this,s,e))}!f&&!e.silent&&this._changed&&this.change(e);this._changing=!1;return this},unset:function(a,e){if(!(a in this.attributes))return this;e||(e={});var c={};c[a]=void 0;if(!e.silent&&this.validate&&!this._performValidation(c,e))return!1;delete this.attributes[a];delete this._escapedAttributes[a];a==this.idAttribute&&delete this.id;this._changed=!0;e.silent||(this.trigger("change:"+
a,this,void 0,e),this.change(e));return this},clear:function(a){a||(a={});var e,c=this.attributes,d={};for(e in c)d[e]=void 0;if(!a.silent&&this.validate&&!this._performValidation(d,a))return!1;this.attributes={};this._escapedAttributes={};this._changed=!0;if(!a.silent){for(e in c)this.trigger("change:"+e,this,void 0,a);this.change(a)}return this},fetch:function(a){a||(a={});var e=this,c=a.success;a.success=function(d,f,k){if(!e.set(e.parse(d,k),a))return!1;c&&c(e,d)};a.error=D(a.error,e,a);return(this.sync||
r.sync).call(this,"read",this,a)},save:function(a,e){e||(e={});if(a&&!this.set(a,e))return!1;var c=this,d=e.success;e.success=function(a,f,h){if(!c.set(c.parse(a,h),e))return!1;d&&d(c,a,h)};e.error=D(e.error,c,e);var f=this.isNew()?"create":"update";return(this.sync||r.sync).call(this,f,this,e)},destroy:function(a){a||(a={});if(this.isNew())return this.trigger("destroy",this,this.collection,a);var e=this,c=a.success;a.success=function(d){e.trigger("destroy",e,e.collection,a);c&&c(e,d)};a.error=D(a.error,
e,a);return(this.sync||r.sync).call(this,"delete",this,a)},url:function(){var a=l(this.collection)||this.urlRoot||q();return this.isNew()?a:a+("/"==a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this)},isNew:function(){return null==this.id},change:function(a){this.trigger("change",this,a);this._previousAttributes=j.clone(this.attributes);this._changed=!1},hasChanged:function(a){return a?this._previousAttributes[a]!=
this.attributes[a]:this._changed},changedAttributes:function(a){a||(a=this.attributes);var e=this._previousAttributes,c=!1,d;for(d in a)j.isEqual(e[d],a[d])||(c=c||{},c[d]=a[d]);return c},previous:function(a){return!a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return j.clone(this._previousAttributes)},_performValidation:function(a,e){var c=this.validate(a);return c?(e.error?e.error(this,c,e):this.trigger("error",this,c,e),!1):!0}});r.Collection=function(a,
e){e||(e={});e.comparator&&(this.comparator=e.comparator);j.bindAll(this,"_onModelEvent","_removeReference");this._reset();a&&this.reset(a,{silent:!0});this.initialize.apply(this,arguments)};j.extend(r.Collection.prototype,r.Events,{model:r.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,e){if(j.isArray(a))for(var c=0,d=a.length;c<d;c++)this._add(a[c],e);else this._add(a,e);return this},remove:function(a,e){if(j.isArray(a))for(var c=
0,d=a.length;c<d;c++)this._remove(a[c],e);else this._remove(a,e);return this},get:function(a){return null==a?null:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return j.map(this.models,function(e){return e.get(a)})},
reset:function(a,e){a||(a=[]);e||(e={});this.each(this._removeReference);this._reset();this.add(a,{silent:!0});e.silent||this.trigger("reset",this,e);return this},fetch:function(a){a||(a={});var e=this,c=a.success;a.success=function(d,f,k){e[a.add?"add":"reset"](e.parse(d,k),a);c&&c(e,d)};a.error=D(a.error,e,a);return(this.sync||r.sync).call(this,"read",this,a)},create:function(a,e){var c=this;e||(e={});a=this._prepareModel(a,e);if(!a)return!1;var d=e.success;e.success=function(a,k,f){c.add(a,e);
d&&d(a,k,f)};a.save(null,e);return a},parse:function(a){return a},chain:function(){return j(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(a,e){if(a instanceof r.Model)a.collection||(a.collection=this);else{var c=a;a=new this.model(c,{collection:this});a.validate&&!a._performValidation(c,e)&&(a=!1)}return a},_add:function(a,e){e||(e={});a=this._prepareModel(a,e);if(!a)return!1;var c=this.getByCid(a)||this.get(a);if(c)throw Error(["Can't add the same model to a set twice",
c.id]);this._byId[a.id]=a;this._byCid[a.cid]=a;this.models.splice(null!=e.at?e.at:this.comparator?this.sortedIndex(a,this.comparator):this.length,0,a);a.bind("all",this._onModelEvent);this.length++;e.silent||a.trigger("add",a,this,e);return a},_remove:function(a,e){e||(e={});a=this.getByCid(a)||this.get(a);if(!a)return null;delete this._byId[a.id];delete this._byCid[a.cid];this.models.splice(this.indexOf(a),1);this.length--;e.silent||a.trigger("remove",a,this,e);this._removeReference(a);return a},
_removeReference:function(a){this==a.collection&&delete a.collection;a.unbind("all",this._onModelEvent)},_onModelEvent:function(a,e,c,d){("add"==a||"remove"==a)&&c!=this||("destroy"==a&&this._remove(e,d),e&&a==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],this._byId[e.id]=e),this.trigger.apply(this,arguments))}});j.each("forEach each map reduce reduceRight find detect filter select reject every all some any include contains invoke max min sortBy sortedIndex toArray size first rest last without indexOf lastIndexOf isEmpty".split(" "),
function(a){r.Collection.prototype[a]=function(){return j[a].apply(j,[this.models].concat(j.toArray(arguments)))}});r.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)};var c=/:([\w\d]+)/g,n=/\*([\w\d]+)/g,z=/[-[\]{}()+?.,\\^$|#\s]/g;j.extend(r.Router.prototype,r.Events,{initialize:function(){},route:function(a,e,c){r.history||(r.history=new r.History);j.isRegExp(a)||(a=this._routeToRegExp(a));r.history.route(a,j.bind(function(d){d=
this._extractParameters(a,d);c.apply(this,d);this.trigger.apply(this,["route:"+e].concat(d))},this))},navigate:function(a,e){r.history.navigate(a,e)},_bindRoutes:function(){if(this.routes){var a=[],e;for(e in this.routes)a.unshift([e,this.routes[e]]);e=0;for(var c=a.length;e<c;e++)this.route(a[e][0],a[e][1],this[a[e][1]])}},_routeToRegExp:function(a){a=a.replace(z,"\\$&").replace(c,"([^/]*)").replace(n,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,e){return a.exec(e).slice(1)}});
r.History=function(){this.handlers=[];j.bindAll(this,"checkUrl")};var d=/^#*/,w=/msie [\w.]+/,g=!1;j.extend(r.History.prototype,{interval:50,getFragment:function(a,e){if(null==a)if(this._hasPushState||e){a=window.location.pathname;var c=window.location.search;c&&(a+=c);0==a.indexOf(this.options.root)&&(a=a.substr(this.options.root.length))}else a=window.location.hash;return a.replace(d,"")},start:function(a){if(g)throw Error("Backbone.history has already been started");this.options=j.extend({},{root:"/"},
this.options,a);this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);a=this.getFragment();var e=document.documentMode;if(e=w.exec(navigator.userAgent.toLowerCase())&&(!e||7>=e))this.iframe=A('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);this._hasPushState?A(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!e?A(window).bind("hashchange",this.checkUrl):
setInterval(this.checkUrl,this.interval);this.fragment=a;g=!0;a=window.location;e=a.pathname==this.options.root;this._wantsPushState&&!this._hasPushState&&!e?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment)):this._wantsPushState&&(this._hasPushState&&e&&a.hash)&&(this.fragment=a.hash.replace(d,""),window.history.replaceState({},document.title,a.protocol+"//"+a.host+this.options.root+this.fragment));return this.loadUrl()},route:function(a,e){this.handlers.unshift({route:a,
callback:e})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.iframe.location.hash));if(a==this.fragment||a==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var e=this.fragment=this.getFragment(a);return j.any(this.handlers,function(a){if(a.route.test(e))return a.callback(e),!0})},navigate:function(a,e){var c=(a||"").replace(d,"");if(!(this.fragment==
c||this.fragment==decodeURIComponent(c))){if(this._hasPushState){var f=window.location;0!=c.indexOf(this.options.root)&&(c=this.options.root+c);this.fragment=c;window.history.pushState({},document.title,f.protocol+"//"+f.host+c)}else if(window.location.hash=this.fragment=c,this.iframe&&c!=this.getFragment(this.iframe.location.hash))this.iframe.document.open().close(),this.iframe.location.hash=c;e&&this.loadUrl(a)}}});r.View=function(a){this.cid=j.uniqueId("view");this._configure(a||{});this._ensureElement();
this.delegateEvents();this.initialize.apply(this,arguments)};var N=/^(\S+)\s*(.*)$/,J="model collection el id attributes className tagName".split(" ");j.extend(r.View.prototype,r.Events,{tagName:"div",$:function(a){return A(a,this.el)},initialize:function(){},render:function(){return this},remove:function(){A(this.el).remove();return this},make:function(a,e,c){a=document.createElement(a);e&&A(a).attr(e);c&&A(a).html(c);return a},delegateEvents:function(a){if(a||(a=this.events))for(var e in A(this.el).unbind(".delegateEvents"+
this.cid),a){var c=this[a[e]];if(!c)throw Error('Event "'+a[e]+'" does not exist');var d=e.match(N),f=d[1],d=d[2],c=j.bind(c,this),f=f+(".delegateEvents"+this.cid);""===d?A(this.el).bind(f,c):A(this.el).delegate(d,f,c)}},_configure:function(a){this.options&&(a=j.extend({},this.options,a));for(var e=0,c=J.length;e<c;e++){var d=J[e];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(this.el)j.isString(this.el)&&(this.el=A(this.el).get(0));else{var a=this.attributes||{};this.id&&(a.id=
this.id);this.className&&(a["class"]=this.className);this.el=this.make(this.tagName,a)}}});r.Model.extend=r.Collection.extend=r.Router.extend=r.View.extend=function(a,e){var c=this,d;d=a&&a.hasOwnProperty("constructor")?a.constructor:function(){return c.apply(this,arguments)};j.extend(d,c);f.prototype=c.prototype;d.prototype=new f;a&&j.extend(d.prototype,a);e&&j.extend(d,e);d.prototype.constructor=d;d.__super__=c.prototype;d.extend=this.extend;return d};var K={create:"POST",update:"PUT","delete":"DELETE",
read:"GET"};r.sync=function(a,e,c){var d=K[a];c=j.extend({type:d,dataType:"json",processData:!1},c);c.url||(c.url=l(e)||q());if(!c.data&&e&&("create"==a||"update"==a))c.contentType="application/json",c.data=JSON.stringify(e.toJSON());r.emulateJSON&&(c.contentType="application/x-www-form-urlencoded",c.processData=!0,c.data=c.data?{model:c.data}:{});if(r.emulateHTTP&&("PUT"===d||"DELETE"===d))r.emulateJSON&&(c.data._method=d),c.type="POST",c.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",
d)};return A.ajax(c)};var f=function(){},l=function(a){return!a||!a.url?null:j.isFunction(a.url)?a.url():a.url},q=function(){throw Error('A "url" property or function must be specified');},D=function(a,c,d){return function(f){a?a(c,f,d):c.trigger("error",c,f,d)}}}).call(this);/*
 
 JavaScript Debug - v0.4 - 6/22/2010
 http://benalman.com/projects/javascript-debug-console-log/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/

 With lots of help from Paul Irish!
 http://paulirish.com/
*/
window.debug=function(){function h(d){c&&(n||!j||!j.log)&&c.apply(B,d)}for(var B=this,r=Array.prototype.slice,j=B.console,A={},c,n,z=9,d=["error","warn","info","debug","log"],w="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),g=w.length,N=[];0<=--g;)(function(c){A[c]=function(){0!==z&&j&&j[c]&&j[c].apply(j,arguments)}})(w[g]);for(g=d.length;0<=--g;)(function(c,g){A[g]=function(){var f=r.call(arguments),l=[g].concat(f);N.push(l);
h(l);if(j&&(0<z?z>c:d.length+z<=c))j.firebug?j[g].apply(B,f):j[g]?j[g](f):j.log(f)}})(g,d[g]);A.setLevel=function(c){z="number"===typeof c?c:9};A.setCallback=function(){var d=r.call(arguments),g=N.length,f=g;c=d.shift()||null;n="boolean"===typeof d[0]?d.shift():!1;for(f-="number"===typeof d[0]?d.shift():g;f<g;)h(N[f++])};return A}();/*

 jQuery Templates Plugin 1.0.0pre
 http://github.com/jquery/jquery-tmpl
 Requires jQuery 1.4.2

 Copyright Software Freedom Conservancy, Inc.
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(h){function B(a,c,e,f){f={data:f||0===f||!1===f?f:c?c.data:{},_wrap:c?c._wrap:null,tmpl:null,parent:c||null,nodes:[],calls:d,nest:w,wrap:g,html:N,update:J};a&&h.extend(f,a,{nodes:[],parent:c});e&&(f.tmpl=e,f._ctnt=f._ctnt||f.tmpl(h,f),f.key=++H,(x.length?D:q)[H]=f);return f}function r(a,c,e){var d;e=e?h.map(e,function(c){return"string"===typeof c?a.key?c.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+f+'="'+a.key+'" $2'):c:r(c,a,c._ctnt)}):a;if(c)return e;e=e.join("");e.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(a,c,e,k){d=h(e).get();z(d);c&&(d=j(c).concat(d));k&&(d=d.concat(j(k)))});return d?d:j(e)}function j(a){var c=document.createElement("div");c.innerHTML=a;return h.makeArray(c.childNodes)}function A(a){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+h.trim(a).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(a,c,e,k,d,f,g){a=h.tmpl.tag[e];if(!a)throw"Unknown template tag: "+e;e=a._default||[];f&&!/\w$/.test(d)&&(d+=f,f="");d?(d=n(d),g=g?","+n(g)+")":f?")":"",g=f?-1<d.indexOf(".")?d+n(f):"("+d+").call($item"+g:d,f=f?g:"(typeof("+d+")==='function'?("+d+").call($item):("+d+"))"):f=g=e.$1||"null";k=n(k);return"');"+a[c?"close":"open"].split("$notnull_1").join(d?"typeof("+d+")!=='undefined' && ("+d+")!=null":"true").split("$1a").join(f).split("$1").join(g).split("$2").join(k||e.$2||"")+"__.push('"})+
"');}return __;")}function c(a,c){a._wrap=r(a,!0,h.isArray(c)?c:[l.test(c)?c:h(c).html()]).join("")}function n(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function z(a){function c(a){function k(a){a+=e;s=l[a]=l[a]||B(s,q[s.parent.key+e]||s.parent)}var d,g=a,s,u;if(u=a.getAttribute(f)){for(;g.parentNode&&1===(g=g.parentNode).nodeType&&!(d=g.getAttribute(f)););if(d!==u){g=g.parentNode?11===g.nodeType?0:g.getAttribute(f)||0:0;if(!(s=q[u]))s=D[u],s=B(s,q[g]||D[g]),s.key=++H,q[H]=s;L&&
k(u)}a.removeAttribute(f)}else if(L&&(s=h.data(a,"tmplItem")))k(s.key),q[s.key]=s,g=(g=h.data(a.parentNode,"tmplItem"))?g.key:0;if(s){for(d=s;d&&d.key!=g;)d.nodes.push(a),d=d.parent;delete s._ctnt;delete s._wrap;h.data(a,"tmplItem",s)}}var e="_"+L,d,g,l={},x,w,j;x=0;for(w=a.length;x<w;x++)if(1===(d=a[x]).nodeType){g=d.getElementsByTagName("*");for(j=g.length-1;0<=j;j--)c(g[j]);c(d)}}function d(a,c,e,d){if(!a)return x.pop();x.push({_:a,tmpl:c,item:this,data:e,options:d})}function w(a,c,e){return h.tmpl(h.template(a),
c,e,this)}function g(a,c){var e=a.options||{};e.wrapped=c;return h.tmpl(h.template(a.tmpl),a.data,e,a.item)}function N(a,c){var e=this._wrap;return h.map(h(h.isArray(e)?e.join(""):e).filter(a||"*"),function(a){if(c)a=a.innerText||a.textContent;else{var e;if(!(e=a.outerHTML))e=document.createElement("div"),e.appendChild(a.cloneNode(!0)),e=e.innerHTML;a=e}return a})}function J(){var a=this.nodes;h.tmpl(null,null,null,this).insertBefore(a[0]);h(a).remove()}var K=h.fn.domManip,f="_tmplitem",l=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,
q={},D={},a,e={key:0,data:{}},H=0,L=0,x=[];h.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(c,e){h.fn[c]=function(d){var f=[];d=h(d);var g,l,x;g=1===this.length&&this[0].parentNode;a=q||{};if(g&&11===g.nodeType&&1===g.childNodes.length&&1===d.length)d[e](this[0]),f=this;else{l=0;for(x=d.length;l<x;l++)L=l,g=(0<l?this.clone(!0):this).get(),h(d[l])[e](g),f=f.concat(g);L=0;f=this.pushStack(f,c,d.selector)}d=a;a=null;h.tmpl.complete(d);
return f}});h.fn.extend({tmpl:function(a,c,e){return h.tmpl(this[0],a,c,e)},tmplItem:function(){return h.tmplItem(this[0])},template:function(a){return h.template(a,this[0])},domManip:function(c,e,d,f){if(c[0]&&h.isArray(c[0])){for(var g=h.makeArray(arguments),l=c[0],x=l.length,j=0,w;j<x&&!(w=h.data(l[j++],"tmplItem")););w&&L&&(g[2]=function(a){h.tmpl.afterManip(this,a,d)});K.apply(this,g)}else K.apply(this,arguments);L=0;a||h.tmpl.complete(q);return this}});h.extend({tmpl:function(a,d,f,g){var l=
!g;if(l)g=e,a=h.template[a]||h.template(null,a),D={};else if(!a)return a=g.tmpl,q[g.key]=g,g.nodes=[],g.wrapped&&c(g,g.wrapped),h(r(g,null,g.tmpl(h,g)));if(!a)return[];"function"===typeof d&&(d=d.call(g||{}));f&&f.wrapped&&c(f,f.wrapped);d=h.isArray(d)?h.map(d,function(c){return c?B(f,g,a,c):null}):[B(f,g,a,d)];return l?h(r(g,null,d)):d},tmplItem:function(a){var c;for(a instanceof h&&(a=a[0]);a&&1===a.nodeType&&!(c=h.data(a,"tmplItem"))&&(a=a.parentNode););return c||e},template:function(a,c){return c?
("string"===typeof c?c=A(c):c instanceof h&&(c=c[0]||{}),c.nodeType&&(c=h.data(c,"tmpl")||h.data(c,"tmpl",A(c.innerHTML))),"string"===typeof a?h.template[a]=c:c):a?"string"!==typeof a?h.template(null,a):h.template[a]||h.template(null,l.test(a)?a:h(a)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});h.extend(h.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},
open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){q={}},afterManip:function(a,
c,e){var d=11===c.nodeType?h.makeArray(c.childNodes):1===c.nodeType?[c]:[];e.call(a,c);z(d);L++}})})(jQuery);/*

 Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 Licensed under the MIT License (LICENSE.txt).

 Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 Thanks to: Seamus Leahy for adding deltaX and deltaY

 Version: 3.0.4

 Requires: 1.2.2+
*/
(function(h){function B(j){var r=j||window.event,c=[].slice.call(arguments,1),n=0,z=0,d=0;j=h.event.fix(r);j.type="mousewheel";j.wheelDelta&&(n=j.wheelDelta/120);j.detail&&(n=-j.detail/3);d=n;void 0!==r.axis&&r.axis===r.HORIZONTAL_AXIS&&(d=0,z=-1*n);void 0!==r.wheelDeltaY&&(d=r.wheelDeltaY/120);void 0!==r.wheelDeltaX&&(z=-1*r.wheelDeltaX/120);c.unshift(j,n,z,d);return h.event.handle.apply(this,c)}var r=["DOMMouseScroll","mousewheel"];h.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var h=
r.length;h;)this.addEventListener(r[--h],B,!1);else this.onmousewheel=B},teardown:function(){if(this.removeEventListener)for(var h=r.length;h;)this.removeEventListener(r[--h],B,!1);else this.onmousewheel=null}};h.fn.extend({mousewheel:function(h){return h?this.bind("mousewheel",h):this.trigger("mousewheel")},unmousewheel:function(h){return this.unbind("mousewheel",h)}})})(jQuery);/*

 jQuery.UI.iPad plugin
 Copyright (c) 2010 Stephen von Takach
 licensed under MIT.
 Date: 27/8/2010

 Project Home: 
 http://code.google.com/p/jquery-ui-for-ipad-and-iphone/
*/
(function(h){function B(){z&&(window.clearTimeout(w),z=!1,d=null)}function r(c){z||(z=!0,d=c.changedTouches[0],w=window.setTimeout(function(){z=!1;var c=d,h=document.createEvent("MouseEvent");h.initMouseEvent("mouseup",!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null);c.target.dispatchEvent(h);h=document.createEvent("MouseEvent");h.initMouseEvent("mousedown",!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,2,null);c.target.dispatchEvent(h);h=document.createEvent("MouseEvent");
h.initMouseEvent("contextmenu",!0,!0,window,1,c.screenX+50,c.screenY+5,c.clientX+50,c.clientY+5,!1,!1,!1,!1,2,null);c.target.dispatchEvent(h);g=!0;d=null},800))}function j(d){var w="";if(!(1<d.touches.length)){switch(d.type){case "gesturestart":alert("gesturestart");d.preventDefault();break;case "touchstart":if(h(d.changedTouches[0].target).is("select"))return;var w=d.changedTouches[0],j="mouseover",f=document.createEvent("MouseEvent");f.initMouseEvent(j,!0,!0,window,1,w.screenX,w.screenY,w.clientX,
w.clientY,!1,!1,!1,!1,0,null);w.target.dispatchEvent(f);j="mousedown";f=document.createEvent("MouseEvent");f.initMouseEvent(j,!0,!0,window,1,w.screenX,w.screenY,w.clientX,w.clientY,!1,!1,!1,!1,0,null);w.target.dispatchEvent(f);c?(window.clearTimeout(n),w.target==A?(A=null,c=!1,j="click",f=document.createEvent("MouseEvent"),f.initMouseEvent(j,!0,!0,window,1,w.screenX,w.screenY,w.clientX,w.clientY,!1,!1,!1,!1,0,null),w.target.dispatchEvent(f),j="dblclick",f=document.createEvent("MouseEvent"),f.initMouseEvent(j,
!0,!0,window,1,w.screenX,w.screenY,w.clientX,w.clientY,!1,!1,!1,!1,0,null),w.target.dispatchEvent(f)):(A=w.target,c=!0,n=window.setTimeout(function(){c=!1},600),r(d))):(A=w.target,c=!0,n=window.setTimeout(function(){c=!1},600),r(d));d.preventDefault();return!1;case "touchmove":B();w="mousemove";d.preventDefault();break;case "touchend":if(g)return g=!1,d.preventDefault(),!1;B();w="mouseup";break;default:return}d=d.changedTouches[0];j=document.createEvent("MouseEvent");j.initMouseEvent(w,!0,!0,window,
1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null);d.target.dispatchEvent(j);"mouseup"==w&&(c&&d.target==A)&&(j=document.createEvent("MouseEvent"),j.initMouseEvent("click",!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),d.target.dispatchEvent(j))}}h.extend(h.support,{touch:"object"==typeof Touch});h.fn.addTouch=function(){h.support.touch&&this.each(function(c,d){d.addEventListener("touchstart",j,!1);d.addEventListener("touchmove",j,!1);d.addEventListener("touchend",
j,!1);d.addEventListener("touchcancel",j,!1)})};var A=null,c=!1,n=null,z=!1,d=null,w=null,g=!1})(jQuery);/*

 Raphael 1.5.2 - JavaScript Vector Library

 Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 Licensed under the MIT (http://raphaeljs.com/license.html) license.
*/
(function(){function h(){if(h.is(arguments[0],X)){for(var p=arguments[0],a=wa[q](h,p.splice(0,3+h.is(p[0],V))),c=a.set(),e=0,d=p[k];e<d;e++){var m=p[e]||{};n[w](m.type)&&c[R](a[m.type]().attr(m))}return c}return wa[q](h,arguments)}function B(){for(var p=[],a=0;32>a;a++)p[a]=(~~(16*y.random()))[da](16);p[12]=4;p[16]=(p[16]&3|8)[da](16);return"r-"+p[x]("")}function r(p,a,c){function e(){var Ka=Array[d].slice.call(arguments,0),m=Ka[x]("\u25ba"),f=e.cache=e.cache||{},g=e.count=e.count||[];if(f[w](m))return c?
c(f[m]):f[m];1E3<=g[k]&&delete f[g.shift()];g[R](m);f[m]=p[q](a,Ka);return c?c(f[m]):f[m]}return e}function j(){return this.x+a+this.y}function A(p){return function(a,c,e,d){var m={back:p};h.is(e,"function")?d=e:m.rot=e;a&&a.constructor==Q&&(a=a.attrs.path);a&&(m.along=a);return this.animate(m,c,d)}}h.version="1.5.2";var c=/[, ]+/,n={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},z=/\{(\d+)\}/g,d="prototype",w="hasOwnProperty",g=document,N=window,J=Object[d][w].call(N,"Raphael"),K=N.Raphael,f=function(){this.customAttributes=
{}},l,q="apply",D="createTouch"in g,a=" ",e=String,H="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(a),L={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},x="join",k="length",s=e[d].toLowerCase,y=Math,u=y.max,M=y.min,U=y.abs,C=y.pow,S=y.PI,V="number",X="array",da="toString",kb=Object[d][da],R="push",T=/^url\(['"]?([^\)]+?)['"]?\)$/i,$=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
O={NaN:1,Infinity:1,"-Infinity":1},Y=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,I=y.round,F=parseFloat,aa=parseInt,ea=e[d].toUpperCase,ma={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt",
"stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},xa={along:"along",blur:V,"clip-rect":"csv",cx:V,cy:V,fill:"colour","fill-opacity":V,"font-size":V,height:V,opacity:V,path:"path",r:V,rotation:"csv",rx:V,ry:V,scale:"csv",stroke:"colour","stroke-opacity":V,"stroke-width":V,translation:"csv",width:V,x:V,y:V},lb=/^(from|to|\d+%?)$/,ya=/\s*,\s*/,mb={hs:1,rg:1},nb=/,?([achlmqrstvxz]),?/gi,
ob=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,pb=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,La=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,qb=function(p,a){return p.key-a.key};h.type=N.SVGAngle||g.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if("VML"==h.type){var za=g.createElement("div"),na;za.innerHTML='<v:shape adj="1"/>';na=za.firstChild;na.style.behavior="url(#default#VML)";if(!(na&&"object"==typeof na.adj))return h.type=null;za=
null}h.svg=!(h.vml="VML"==h.type);f[d]=h[d];l=f[d];h._id=0;h._oid=0;h.fn={};h.is=function(p,a){a=s.call(a);return"finite"==a?!O[w](+p):"null"==a&&null===p||a==typeof p||"object"==a&&p===Object(p)||"array"==a&&Array.isArray&&Array.isArray(p)||kb.call(p).slice(8,-1).toLowerCase()==a};h.angle=function(p,a,c,e,d,m){return null==d?(p-=c,a-=e,!p&&!a?0:(180*(0>p)+180*y.atan(-a/-p)/S+360)%360):h.angle(p,a,d,m)-h.angle(c,e,d,m)};h.rad=function(p){return p%360*S/180};h.deg=function(p){return 180*p/S%360};h.snapTo=
function(p,a,c){c=h.is(c,"finite")?c:10;if(h.is(p,X))for(var e=p.length;e--;){if(U(p[e]-a)<=c)return p[e]}else{p=+p;e=a%p;if(e<c)return a-e;if(e>p-c)return a-e+p}return a};h.setWindow=function(p){N=p;g=N.document};var oa=function(p){if(h.vml){var a=/^\s+|\s+$/g,c;try{var d=new ActiveXObject("htmlfile");d.write("<body>");d.close();c=d.body}catch(k){c=createPopup().document.body}var m=c.createTextRange();oa=r(function(p){try{c.style.color=e(p).replace(a,"");var d=m.queryCommandValue("ForeColor");return"#"+
("000000"+((d&255)<<16|d&65280|(d&16711680)>>>16)[da](16)).slice(-6)}catch(Cb){return"none"}})}else{var f=g.createElement("i");f.title="Rapha\u00ebl Colour Picker";f.style.display="none";g.body.appendChild(f);oa=r(function(p){f.style.color=p;return g.defaultView.getComputedStyle(f,"").getPropertyValue("color")})}return oa(p)},Ma=function(){return"hsb("+[this.h,this.s,this.b]+")"},rb=function(){return"hsl("+[this.h,this.s,this.l]+")"},sb=function(){return this.hex};h.hsb2rgb=function(p,a,c,e){h.is(p,
"object")&&("h"in p&&"s"in p&&"b"in p)&&(c=p.b,a=p.s,p=p.h,e=p.o);return h.hsl2rgb(p,a,c/2,e)};h.hsl2rgb=function(p,a,c,e){h.is(p,"object")&&("h"in p&&"s"in p&&"l"in p)&&(c=p.l,a=p.s,p=p.h);if(1<p||1<a||1<c)p/=360,a/=100,c/=100;var d={},m=["r","g","b"],k;if(a){0.5>c?k=c*(1+a):k=c+a-c*a;a=2*c-k;for(var f=0;3>f;f++)c=p+1/3*-(f-1),0>c&&c++,1<c&&c--,1>6*c?d[m[f]]=a+6*(k-a)*c:1>2*c?d[m[f]]=k:2>3*c?d[m[f]]=a+6*(k-a)*(2/3-c):d[m[f]]=a}else d={r:c,g:c,b:c};d.r*=255;d.g*=255;d.b*=255;d.hex="#"+(16777216|d.b|
d.g<<8|d.r<<16).toString(16).slice(1);h.is(e,"finite")&&(d.opacity=e);d.toString=sb;return d};h.rgb2hsb=function(p,a,c){null==a&&(h.is(p,"object")&&"r"in p&&"g"in p&&"b"in p)&&(c=p.b,a=p.g,p=p.r);null==a&&h.is(p,"string")&&(c=h.getRGB(p),p=c.r,a=c.g,c=c.b);if(1<p||1<a||1<c)p/=255,a/=255,c/=255;var e=u(p,a,c),d=M(p,a,c),m;if(d==e)return{h:0,s:0,b:e,toString:Ma};d=e-d;p==e?m=(a-c)/d:a==e?m=2+(c-p)/d:m=4+(p-a)/d;m/=6;0>m&&m++;1<m&&m--;return{h:m,s:d/e,b:e,toString:Ma}};h.rgb2hsl=function(p,a,c){null==
a&&(h.is(p,"object")&&"r"in p&&"g"in p&&"b"in p)&&(c=p.b,a=p.g,p=p.r);null==a&&h.is(p,"string")&&(c=h.getRGB(p),p=c.r,a=c.g,c=c.b);if(1<p||1<a||1<c)p/=255,a/=255,c/=255;var e=u(p,a,c),d=M(p,a,c),m,k=(e+d)/2;if(d==e)p={h:0,s:0,l:k};else{var f=e-d;p==e?m=(a-c)/f:a==e?m=2+(c-p)/f:m=4+(p-a)/f;m/=6;0>m&&m++;1<m&&m--;p={h:m,s:0.5>k?f/(e+d):f/(2-e-d),l:k}}p.toString=rb;return p};h._path2string=function(){return this.join(",").replace(nb,"$1")};h.getRGB=r(function(p){if(!p||(p=e(p)).indexOf("-")+1)return{r:-1,
g:-1,b:-1,hex:"none",error:1};if("none"==p)return{r:-1,g:-1,b:-1,hex:"none"};!(mb[w](p.toLowerCase().substring(0,2))||"#"==p.charAt())&&(p=oa(p));var a,c,d,k,m;if(p=p.match($)){p[2]&&(d=aa(p[2].substring(5),16),c=aa(p[2].substring(3,5),16),a=aa(p[2].substring(1,3),16));p[3]&&(d=aa((m=p[3].charAt(3))+m,16),c=aa((m=p[3].charAt(2))+m,16),a=aa((m=p[3].charAt(1))+m,16));p[4]&&(m=p[4].split(ya),a=F(m[0]),"%"==m[0].slice(-1)&&(a*=2.55),c=F(m[1]),"%"==m[1].slice(-1)&&(c*=2.55),d=F(m[2]),"%"==m[2].slice(-1)&&
(d*=2.55),"rgba"==p[1].toLowerCase().slice(0,4)&&(k=F(m[3])),m[3]&&"%"==m[3].slice(-1)&&(k/=100));if(p[5])return m=p[5].split(ya),a=F(m[0]),"%"==m[0].slice(-1)&&(a*=2.55),c=F(m[1]),"%"==m[1].slice(-1)&&(c*=2.55),d=F(m[2]),"%"==m[2].slice(-1)&&(d*=2.55),("deg"==m[0].slice(-3)||"\u00b0"==m[0].slice(-1))&&(a/=360),"hsba"==p[1].toLowerCase().slice(0,4)&&(k=F(m[3])),m[3]&&"%"==m[3].slice(-1)&&(k/=100),h.hsb2rgb(a,c,d,k);if(p[6])return m=p[6].split(ya),a=F(m[0]),"%"==m[0].slice(-1)&&(a*=2.55),c=F(m[1]),
"%"==m[1].slice(-1)&&(c*=2.55),d=F(m[2]),"%"==m[2].slice(-1)&&(d*=2.55),("deg"==m[0].slice(-3)||"\u00b0"==m[0].slice(-1))&&(a/=360),"hsla"==p[1].toLowerCase().slice(0,4)&&(k=F(m[3])),m[3]&&"%"==m[3].slice(-1)&&(k/=100),h.hsl2rgb(a,c,d,k);p={r:a,g:c,b:d};p.hex="#"+(16777216|d|c<<8|a<<16).toString(16).slice(1);h.is(k,"finite")&&(p.opacity=k);return p}return{r:-1,g:-1,b:-1,hex:"none",error:1}},h);h.getColor=function(p){p=this.getColor.start=this.getColor.start||{h:0,s:1,b:p||0.75};var a=this.hsb2rgb(p.h,
p.s,p.b);p.h+=0.075;1<p.h&&(p.h=0,p.s-=0.2,0>=p.s&&(this.getColor.start={h:0,s:1,b:p.b}));return a.hex};h.getColor.reset=function(){delete this.start};h.parsePathString=r(function(a){if(!a)return null;var c={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=[];h.is(a,X)&&h.is(a[0],X)&&(d=pa(a));d[k]||e(a).replace(ob,function(a,p,e){var f=[];a=s.call(p);e.replace(pb,function(a,p){p&&f[R](+p)});"m"==a&&2<f[k]&&(d[R]([p].concat(f.splice(0,2))),a="l",p="m"==p?"l":"L");for(;f[k]>=c[a]&&!(d[R]([p].concat(f.splice(0,
c[a]))),!c[a]););});d[da]=h._path2string;return d});h.findDotsAtSegment=function(a,c,d,e,k,m,f,g,h){var v=1-h,l=C(v,3)*a+3*C(v,2)*h*d+3*v*h*h*k+C(h,3)*f,v=C(v,3)*c+3*C(v,2)*h*e+3*v*h*h*m+C(h,3)*g,x=a+2*h*(d-a)+h*h*(k-2*d+a),q=c+2*h*(e-c)+h*h*(m-2*e+c),w=d+2*h*(k-d)+h*h*(f-2*k+d),s=e+2*h*(m-e)+h*h*(g-2*m+e);a=(1-h)*a+h*d;c=(1-h)*c+h*e;k=(1-h)*k+h*f;m=(1-h)*m+h*g;g=90-180*y.atan((x-w)/(q-s))/S;(x>w||q<s)&&(g+=180);return{x:l,y:v,m:{x:x,y:q},n:{x:w,y:s},start:{x:a,y:c},end:{x:k,y:m},alpha:g}};var ra=
r(function(a){if(!a)return{x:0,y:0,width:0,height:0};a=qa(a);for(var c=0,d=0,e=[],f=[],m,h=0,g=a[k];h<g;h++)m=a[h],"M"==m[0]?(c=m[1],d=m[2],e[R](c),f[R](d)):(c=tb(c,d,m[1],m[2],m[3],m[4],m[5],m[6]),e=e.concat(c.min.x,c.max.x),f=f.concat(c.min.y,c.max.y),c=m[5],d=m[6]);a=M[q](0,e);m=M[q](0,f);return{x:a,y:m,width:u[q](0,e)-a,height:u[q](0,f)-m}}),pa=function(a){var c=[];if(!h.is(a,X)||!h.is(a&&a[0],X))a=h.parsePathString(a);for(var e=0,d=a[k];e<d;e++){c[e]=[];for(var f=0,m=a[e][k];f<m;f++)c[e][f]=
a[e][f]}c[da]=h._path2string;return c},Aa=r(function(a){if(!h.is(a,X)||!h.is(a&&a[0],X))a=h.parsePathString(a);var c=[],e=0,d=0,f=0,m=0,g=0;"M"==a[0][0]&&(e=a[0][1],d=a[0][2],f=e,m=d,g++,c[R](["M",e,d]));for(var l=a[k];g<l;g++){var E=c[g]=[],v=a[g];if(v[0]!=s.call(v[0]))switch(E[0]=s.call(v[0]),E[0]){case "a":E[1]=v[1];E[2]=v[2];E[3]=v[3];E[4]=v[4];E[5]=v[5];E[6]=+(v[6]-e).toFixed(3);E[7]=+(v[7]-d).toFixed(3);break;case "v":E[1]=+(v[1]-d).toFixed(3);break;case "m":f=v[1],m=v[2];default:for(var x=
1,q=v[k];x<q;x++)E[x]=+(v[x]-(x%2?e:d)).toFixed(3)}else{c[g]=[];"m"==v[0]&&(f=v[1]+e,m=v[2]+d);E=0;for(x=v[k];E<x;E++)c[g][E]=v[E]}v=c[g][k];switch(c[g][0]){case "z":e=f;d=m;break;case "h":e+=+c[g][v-1];break;case "v":d+=+c[g][v-1];break;default:e+=+c[g][v-2],d+=+c[g][v-1]}}c[da]=h._path2string;return c},0,pa),ia=r(function(a){if(!h.is(a,X)||!h.is(a&&a[0],X))a=h.parsePathString(a);var c=[],e=0,d=0,f=0,m=0,g=0;"M"==a[0][0]&&(e=+a[0][1],d=+a[0][2],f=e,m=d,g++,c[0]=["M",e,d]);for(var l=a[k];g<l;g++){var E=
c[g]=[],v=a[g];if(v[0]!=ea.call(v[0]))switch(E[0]=ea.call(v[0]),E[0]){case "A":E[1]=v[1];E[2]=v[2];E[3]=v[3];E[4]=v[4];E[5]=v[5];E[6]=+(v[6]+e);E[7]=+(v[7]+d);break;case "V":E[1]=+v[1]+d;break;case "H":E[1]=+v[1]+e;break;case "M":f=+v[1]+e,m=+v[2]+d;default:for(var x=1,q=v[k];x<q;x++)E[x]=+v[x]+(x%2?e:d)}else{x=0;for(q=v[k];x<q;x++)c[g][x]=v[x]}switch(E[0]){case "Z":e=f;d=m;break;case "H":e=E[1];break;case "V":d=E[1];break;case "M":f=c[g][c[g][k]-2],m=c[g][c[g][k]-1];default:e=c[g][c[g][k]-2],d=c[g][c[g][k]-
1]}}c[da]=h._path2string;return c},null,pa),Na=function(a,c,e,d,k,m){var f=1/3,g=2/3;return[f*a+g*e,f*c+g*d,f*k+g*e,f*m+g*d,k,m]},Oa=function(a,c,e,d,f,m,g,h,l,v){var q=120*S/180,w=S/180*(+f||0),s=[],j,u=r(function(a,p,c){var e=a*y.cos(c)-p*y.sin(c);a=a*y.sin(c)+p*y.cos(c);return{x:e,y:a}});if(v)C=v[0],j=v[1],m=v[2],n=v[3];else{j=u(a,c,-w);a=j.x;c=j.y;j=u(h,l,-w);h=j.x;l=j.y;y.cos(S/180*f);y.sin(S/180*f);j=(a-h)/2;C=(c-l)/2;n=j*j/(e*e)+C*C/(d*d);1<n&&(n=y.sqrt(n),e*=n,d*=n);var n=e*e,z=d*d,n=(m==
g?-1:1)*y.sqrt(U((n*z-n*C*C-z*j*j)/(n*C*C+z*j*j)));m=n*e*C/d+(a+h)/2;var n=n*-d*j/e+(c+l)/2,C=y.asin(((c-n)/d).toFixed(9));j=y.asin(((l-n)/d).toFixed(9));C=a<m?S-C:C;j=h<m?S-j:j;0>C&&(C=2*S+C);0>j&&(j=2*S+j);g&&C>j&&(C-=2*S);!g&&j>C&&(j-=2*S)}if(U(j-C)>q){var s=j,z=h,D=l;j=C+q*(g&&j>C?1:-1);h=m+e*y.cos(j);l=n+d*y.sin(j);s=Oa(h,l,e,d,f,0,g,z,D,[j,s,m,n])}m=j-C;f=y.cos(C);q=y.sin(C);g=y.cos(j);j=y.sin(j);m=y.tan(m/4);e=4/3*e*m;m*=4/3*d;d=[a,c];a=[a+e*q,c-m*f];c=[h+e*j,l-m*g];h=[h,l];a[0]=2*d[0]-a[0];
a[1]=2*d[1]-a[1];if(v)return[a,c,h].concat(s);s=[a,c,h].concat(s)[x]().split(",");v=[];h=0;for(l=s[k];h<l;h++)v[h]=h%2?u(s[h-1],s[h],w).y:u(s[h],s[h+1],w).x;return v},sa=function(a,c,e,d,k,m,f,g,h){var v=1-h;return{x:C(v,3)*a+3*C(v,2)*h*e+3*v*h*h*k+C(h,3)*f,y:C(v,3)*c+3*C(v,2)*h*d+3*v*h*h*m+C(h,3)*g}},tb=r(function(a,c,e,d,k,m,f,h){var g=k-2*e+a-(f-2*k+e),v=2*(e-a)-2*(k-e),l=a-e,x=(-v+y.sqrt(v*v-4*g*l))/2/g,g=(-v-y.sqrt(v*v-4*g*l))/2/g,j=[c,h],s=[a,f];"1e12"<U(x)&&(x=0.5);"1e12"<U(g)&&(g=0.5);0<x&&
1>x&&(x=sa(a,c,e,d,k,m,f,h,x),s[R](x.x),j[R](x.y));0<g&&1>g&&(x=sa(a,c,e,d,k,m,f,h,g),s[R](x.x),j[R](x.y));g=m-2*d+c-(h-2*m+d);v=2*(d-c)-2*(m-d);l=c-d;x=(-v+y.sqrt(v*v-4*g*l))/2/g;g=(-v-y.sqrt(v*v-4*g*l))/2/g;"1e12"<U(x)&&(x=0.5);"1e12"<U(g)&&(g=0.5);0<x&&1>x&&(x=sa(a,c,e,d,k,m,f,h,x),s[R](x.x),j[R](x.y));0<g&&1>g&&(x=sa(a,c,e,d,k,m,f,h,g),s[R](x.x),j[R](x.y));return{min:{x:M[q](0,s),y:M[q](0,j)},max:{x:u[q](0,s),y:u[q](0,j)}}}),qa=r(function(a,c){var e=ia(a),d=c&&ia(c),f={x:0,y:0,bx:0,by:0,X:0,Y:0,
qx:null,qy:null},m={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g=function(a,p){var c,d;if(!a)return["C",p.x,p.y,p.x,p.y,p.x,p.y];!(a[0]in{T:1,Q:1})&&(p.qx=p.qy=null);switch(a[0]){case "M":p.X=a[1];p.Y=a[2];break;case "A":a=["C"].concat(Oa[q](0,[p.x,p.y].concat(a.slice(1))));break;case "S":c=p.x+(p.x-(p.bx||p.x));d=p.y+(p.y-(p.by||p.y));a=["C",c,d].concat(a.slice(1));break;case "T":p.qx=p.x+(p.x-(p.qx||p.x));p.qy=p.y+(p.y-(p.qy||p.y));a=["C"].concat(Na(p.x,p.y,p.qx,p.qy,a[1],a[2]));break;case "Q":p.qx=
a[1];p.qy=a[2];a=["C"].concat(Na(p.x,p.y,a[1],a[2],a[3],a[4]));break;case "L":a=["C"].concat([p.x,p.y,a[1],a[2],a[1],a[2]]);break;case "H":a=["C"].concat([p.x,p.y,a[1],p.y,a[1],p.y]);break;case "V":a=["C"].concat([p.x,p.y,p.x,a[1],p.x,a[1]]);break;case "Z":a=["C"].concat([p.x,p.y,p.X,p.Y,p.X,p.Y])}return a},h=function(a,p){if(7<a[p][k]){a[p].shift();for(var c=a[p];c[k];)a.splice(p++,0,["C"].concat(c.splice(0,6)));a.splice(p,1);l=u(e[k],d&&d[k]||0)}},x=function(a,p,c,m,ha){a&&(p&&"M"==a[ha][0]&&"M"!=
p[ha][0])&&(p.splice(ha,0,["M",m.x,m.y]),c.bx=0,c.by=0,c.x=a[ha][1],c.y=a[ha][2],l=u(e[k],d&&d[k]||0))},v=0,l=u(e[k],d&&d[k]||0);for(;v<l;v++){e[v]=g(e[v],f);h(e,v);d&&(d[v]=g(d[v],m));d&&h(d,v);x(e,d,f,m,v);x(d,e,m,f,v);var j=e[v],s=d&&d[v],w=j[k],n=d&&s[k];f.x=j[w-2];f.y=j[w-1];f.bx=F(j[w-4])||f.x;f.by=F(j[w-3])||f.y;m.bx=d&&(F(s[n-4])||m.x);m.by=d&&(F(s[n-3])||m.y);m.x=d&&s[n-2];m.y=d&&s[n-1]}return d?[e,d]:e},null,pa),Pa=r(function(a){for(var c=[],d=0,e=a[k];d<e;d++){var f={},m=a[d].match(/^([^:]*):?([\d\.]*)/);
f.color=h.getRGB(m[1]);if(f.color.error)return null;f.color=f.color.hex;m[2]&&(f.offset=m[2]+"%");c[R](f)}d=1;for(e=c[k]-1;d<e;d++)if(!c[d].offset){a=F(c[d-1].offset||0);m=0;for(f=d+1;f<e;f++)if(c[f].offset){m=c[f].offset;break}m||(m=100,f=e);m=F(m);for(m=(m-a)/(f-d+1);d<f;d++)a+=m,c[d].offset=a+"%"}return c}),Qa=function(a,c,d,e){if(h.is(a,"string")||h.is(a,"object")){if(a=h.is(a,"string")?g.getElementById(a):a,a.tagName)return null==c?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||
a.offsetHeight}:{container:a,width:c,height:d}}else return{container:1,x:a,y:c,width:d,height:e}},Ba=function(a,c){var d=this,e;for(e in c)if(c[w](e)&&!(e in a))switch(typeof c[e]){case "function":(function(c){a[e]=a===d?c:function(){return c[q](d,arguments)}})(c[e]);break;case "object":a[e]=a[e]||{};Ba.call(this,a[e],c[e]);break;default:a[e]=c[e]}},ga=function(a,c){a==c.top&&(c.top=a.prev);a==c.bottom&&(c.bottom=a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},Ra=function(a,c){c.top!==
a&&(ga(a,c),a.next=null,a.prev=c.top,c.top.next=a,c.top=a)},Sa=function(a,c){c.bottom!==a&&(ga(a,c),a.next=c.bottom,a.prev=null,c.bottom.prev=a,c.bottom=a)},Ta=function(a,c,d){ga(a,d);c==d.top&&(d.top=a);c.next&&(c.next.prev=a);a.next=c.next;a.prev=c;c.next=a},Ua=function(a,c,d){ga(a,d);c==d.bottom&&(d.bottom=a);c.prev&&(c.prev.next=a);a.prev=c.prev;c.prev=a;a.next=c},Va=function(a){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+a+"\u201d of removed object");}};h.pathToRelative=
Aa;if(h.svg){l.svgns="http://www.w3.org/2000/svg";l.xlink="http://www.w3.org/1999/xlink";var I=function(a){return+a+0.5*(~~a===a)},G=function(a,c){if(c)for(var d in c)c[w](d)&&a.setAttribute(d,e(c[d]));else return a=g.createElementNS(l.svgns,a),a.style.webkitTapHighlightColor="rgba(0,0,0,0)",a};h[da]=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var Wa=function(a,c){var d=G("path");c.canvas&&c.canvas.appendChild(d);d=new Q(d,c);d.type="path";fa(d,{fill:"none",
stroke:"#000",path:a});return d},ja=function(a,c,d){var f="linear",h=0.5,m=0.5,x=a.style;c=e(c).replace(La,function(a,c,p){f="radial";c&&p&&(h=F(c),m=F(p),a=2*(0.5<m)-1,0.25<C(h-0.5,2)+C(m-0.5,2)&&(m=y.sqrt(0.25-C(h-0.5,2))*a+0.5)&&0.5!=m&&(m=m.toFixed(5)-1E-5*a));return""});c=c.split(/\s*\-\s*/);if("linear"==f){var l=c.shift(),l=-F(l);if(isNaN(l))return null;var l=[0,0,y.cos(l*S/180),y.sin(l*S/180)],j=1/(u(U(l[2]),U(l[3]))||1);l[2]*=j;l[3]*=j;0>l[2]&&(l[0]=-l[2],l[2]=0);0>l[3]&&(l[1]=-l[3],l[3]=
0)}c=Pa(c);if(!c)return null;j=a.getAttribute("fill");(j=j.match(/^url\(#(.*)\)$/))&&d.defs.removeChild(g.getElementById(j[1]));j=G(f+"Gradient");j.id=B();G(j,"radial"==f?{fx:h,fy:m}:{x1:l[0],y1:l[1],x2:l[2],y2:l[3]});d.defs.appendChild(j);d=0;for(l=c[k];d<l;d++){var v=G("stop");G(v,{offset:c[d].offset?c[d].offset:d?"100%":"0%","stop-color":c[d].color||"#fff"});j.appendChild(v)}G(a,{fill:"url(#"+j.id+")",opacity:1,"fill-opacity":1});x.fill="";x.opacity=1;return x.fillOpacity=1},Ca=function(a){var c=
a.getBBox();G(a.pattern,{patternTransform:h.format("translate({0},{1})",c.x,c.y)})},fa=function(p,d){var f={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},l=p.node,j=p.attrs,m=p.rotate(),q=function(a,c){if(c=f[s.call(c)]){for(var p=a.attrs["stroke-width"]||"1",e={round:p,square:p,butt:0}[a.attrs["stroke-linecap"]||d["stroke-linecap"]]||0,m=[],g=c[k];g--;)m[g]=c[g]*p+(g%2?1:-1)*e;G(l,{"stroke-dasharray":m[x](",")})}};
d[w]("rotation")&&(m=d.rotation);var u=e(m).split(c);u.length-1?(u[1]=+u[1],u[2]=+u[2]):u=null;F(m)&&p.rotate(0,!0);for(var E in d)if(d[w](E)&&ma[w](E)){var v=d[E];j[E]=v;switch(E){case "blur":p.blur(v);break;case "rotation":p.rotate(v,!0);break;case "href":case "title":case "target":var n=l.parentNode;if("a"!=s.call(n.tagName)){var y=G("a");n.insertBefore(y,l);y.appendChild(l);n=y}"target"==E&&"blank"==v?n.setAttributeNS(p.paper.xlink,"show","new"):n.setAttributeNS(p.paper.xlink,E,v);break;case "cursor":l.style.cursor=
v;break;case "clip-rect":n=e(v).split(c);if(4==n[k]){p.clip&&p.clip.parentNode.parentNode.removeChild(p.clip.parentNode);var z=G("clipPath"),y=G("rect");z.id=B();G(y,{x:n[0],y:n[1],width:n[2],height:n[3]});z.appendChild(y);p.paper.defs.appendChild(z);G(l,{"clip-path":"url(#"+z.id+")"});p.clip=y}v||((v=g.getElementById(l.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,"")))&&v.parentNode.removeChild(v),G(l,{"clip-path":""}),delete p.clip);break;case "path":"path"==p.type&&G(l,{d:v?j.path=ia(v):
"M0,0"});break;case "width":if(l.setAttribute(E,v),j.fx)E="x",v=j.x;else break;case "x":j.fx&&(v=-j.x-(j.width||0));case "rx":if("rx"==E&&"rect"==p.type)break;case "cx":u&&("x"==E||"cx"==E)&&(u[1]+=v-j[E]);l.setAttribute(E,v);p.pattern&&Ca(p);break;case "height":if(l.setAttribute(E,v),j.fy)E="y",v=j.y;else break;case "y":j.fy&&(v=-j.y-(j.height||0));case "ry":if("ry"==E&&"rect"==p.type)break;case "cy":u&&("y"==E||"cy"==E)&&(u[2]+=v-j[E]);l.setAttribute(E,v);p.pattern&&Ca(p);break;case "r":"rect"==
p.type?G(l,{rx:v,ry:v}):l.setAttribute(E,v);break;case "src":"image"==p.type&&l.setAttributeNS(p.paper.xlink,"href",v);break;case "stroke-width":l.style.strokeWidth=v;l.setAttribute(E,v);j["stroke-dasharray"]&&q(p,j["stroke-dasharray"]);break;case "stroke-dasharray":q(p,v);break;case "translation":v=e(v).split(c);v[0]=+v[0]||0;v[1]=+v[1]||0;u&&(u[1]+=v[0],u[2]+=v[1]);ta.call(p,v[0],v[1]);break;case "scale":v=e(v).split(c);p.scale(+v[0]||1,+v[1]||+v[0]||1,isNaN(F(v[2]))?null:+v[2],isNaN(F(v[3]))?null:
+v[3]);break;case "fill":if(n=e(v).match(T)){var z=G("pattern"),C=G("image");z.id=B();G(z,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});G(C,{x:0,y:0});C.setAttributeNS(p.paper.xlink,"href",n[1]);z.appendChild(C);v=g.createElement("img");v.style.cssText="position:absolute;left:-9999em;top-9999em";v.onload=function(){G(z,{width:this.offsetWidth,height:this.offsetHeight});G(C,{width:this.offsetWidth,height:this.offsetHeight});g.body.removeChild(this);p.paper.safari()};g.body.appendChild(v);
v.src=n[1];p.paper.defs.appendChild(z);l.style.fill="url(#"+z.id+")";G(l,{fill:"url(#"+z.id+")"});p.pattern=z;p.pattern&&Ca(p);break}n=h.getRGB(v);if(n.error)if(({circle:1,ellipse:1}[w](p.type)||"r"!=e(v).charAt())&&ja(l,v,p.paper)){j.gradient=v;j.fill="none";break}else delete d.gradient,delete j.gradient,!h.is(j.opacity,"undefined")&&h.is(d.opacity,"undefined")&&G(l,{opacity:j.opacity}),!h.is(j["fill-opacity"],"undefined")&&h.is(d["fill-opacity"],"undefined")&&G(l,{"fill-opacity":j["fill-opacity"]});
n[w]("opacity")&&G(l,{"fill-opacity":1<n.opacity?n.opacity/100:n.opacity});case "stroke":n=h.getRGB(v);l.setAttribute(E,n.hex);"stroke"==E&&n[w]("opacity")&&G(l,{"stroke-opacity":1<n.opacity?n.opacity/100:n.opacity});break;case "gradient":({circle:1,ellipse:1}[w](p.type)||"r"!=e(v).charAt())&&ja(l,v,p.paper);break;case "opacity":j.gradient&&!j[w]("stroke-opacity")&&G(l,{"stroke-opacity":1<v?v/100:v});case "fill-opacity":if(j.gradient){if(n=g.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,
"")))n=n.getElementsByTagName("stop"),n[n[k]-1].setAttribute("stop-opacity",v);break}default:"font-size"==E&&(v=aa(v,10)+"px"),n=E.replace(/(\-.)/g,function(a){return ea.call(a.substring(1))}),l.style[n]=v,l.setAttribute(E,v)}}if(!("text"!=p.type||!d[w]("text")&&!d[w]("font")&&!d[w]("font-size")&&!d[w]("x")&&!d[w]("y"))){j=p.attrs;q=p.node;E=q.firstChild?aa(g.defaultView.getComputedStyle(q.firstChild,"").getPropertyValue("font-size"),10):10;if(d[w]("text")){for(j.text=d.text;q.firstChild;)q.removeChild(q.firstChild);
v=e(d.text).split("\n");n=0;for(y=v[k];n<y;n++)if(v[n]){var r=G("tspan");n&&G(r,{dy:E*Xa,x:j.x});r.appendChild(g.createTextNode(v[n]));q.appendChild(r)}}else{v=q.getElementsByTagName("tspan");n=0;for(y=v[k];n<y;n++)n&&G(v[n],{dy:E*Xa,x:j.x})}G(q,{y:j.y});E=p.getBBox();(E=j.y-(E.y+E.height/2))&&h.is(E,"finite")&&G(q,{y:j.y+E})}u?p.rotate(u.join(a)):F(m)&&p.rotate(m,!0)},Xa=1.2,Q=function(a,c){this[0]=a;this.id=h._oid++;this.node=a;a.raphael=this;this.paper=c;this.attrs=this.attrs||{};this.transformations=
[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=this);c.top=this;this.next=null},P=Q[d];Q[d].rotate=function(p,d,f){if(this.removed)return this;if(null==p)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][x](a):this._.rt.deg;var g=this.getBBox();p=e(p).split(c);p[k]-1&&(d=F(p[1]),f=F(p[2]));p=F(p[0]);null!=d&&!1!==d?this._.rt.deg=p:this._.rt.deg+=p;null==f&&(d=null);this._.rt.cx=d;this._.rt.cy=f;d=null==d?g.x+g.width/2:d;f=
null==f?g.y+g.height/2:f;this._.rt.deg?(this.transformations[0]=h.format("rotate({0} {1} {2})",this._.rt.deg,d,f),this.clip&&G(this.clip,{transform:h.format("rotate({0} {1} {2})",-this._.rt.deg,d,f)})):(this.transformations[0]="",this.clip&&G(this.clip,{transform:""}));G(this.node,{transform:this.transformations[x](a)});return this};Q[d].hide=function(){!this.removed&&(this.node.style.display="none");return this};Q[d].show=function(){!this.removed&&(this.node.style.display="");return this};Q[d].remove=
function(){if(!this.removed){ga(this,this.paper);this.node.parentNode.removeChild(this.node);for(var a in this)delete this[a];this.removed=!0}};Q[d].getBBox=function(){if(this.removed)return this;if("path"==this.type)return ra(this.attrs.path);if("none"==this.node.style.display){this.show();var a=!0}var c={};try{c=this.node.getBBox()}catch(d){}finally{c=c||{}}if("text"==this.type)for(var c={x:c.x,y:Infinity,width:0,height:0},e=0,f=this.node.getNumberOfChars();e<f;e++){var m=this.node.getExtentOfChar(e);
m.y<c.y&&(c.y=m.y);m.y+m.height-c.y>c.height&&(c.height=m.y+m.height-c.y);m.x+m.width-c.x>c.width&&(c.width=m.x+m.width-c.x)}a&&this.hide();return c};Q[d].attr=function(a,c){if(this.removed)return this;if(null==a){var d={},e;for(e in this.attrs)this.attrs[w](e)&&(d[e]=this.attrs[e]);this._.rt.deg&&(d.rotation=this.rotate());(1!=this._.sx||1!=this._.sy)&&(d.scale=this.scale());d.gradient&&"none"==d.fill&&(d.fill=d.gradient)&&delete d.gradient;return d}if(null==c&&h.is(a,"string"))return"translation"==
a?ta.call(this):"rotation"==a?this.rotate():"scale"==a?this.scale():"fill"==a&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[a];if(null==c&&h.is(a,X)){e={};for(var d=0,f=a.length;d<f;d++)e[a[d]]=this.attr(a[d]);return e}null!=c?(d={},d[a]=c):null!=a&&h.is(a,"object")&&(d=a);for(f in this.paper.customAttributes)if(this.paper.customAttributes[w](f)&&d[w](f)&&h.is(this.paper.customAttributes[f],"function")){e=this.paper.customAttributes[f].apply(this,[].concat(d[f]));this.attrs[f]=
d[f];for(var m in e)e[w](m)&&(d[m]=e[m])}fa(this,d);return this};Q[d].toFront=function(){if(this.removed)return this;this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&Ra(this,a);return this};Q[d].toBack=function(){if(this.removed)return this;this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),Sa(this,this.paper));return this};Q[d].insertAfter=function(a){if(this.removed)return this;var c=a.node||a[a.length-
1].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node);Ta(this,a,this.paper);return this};Q[d].insertBefore=function(a){if(this.removed)return this;var c=a.node||a[0].node;c.parentNode.insertBefore(this.node,c);Ua(this,a,this.paper);return this};Q[d].blur=function(a){if(0!==+a){var c=G("filter"),d=G("feGaussianBlur");this.attrs.blur=a;c.id=B();G(d,{stdDeviation:+a||1.5});c.appendChild(d);this.paper.defs.appendChild(c);this._blur=c;G(this.node,
{filter:"url(#"+c.id+")"})}else this._blur&&(this._blur.parentNode.removeChild(this._blur),delete this._blur,delete this.attrs.blur),this.node.removeAttribute("filter")};var Ya=function(a,c,d,e){var f=G("circle");a.canvas&&a.canvas.appendChild(f);a=new Q(f,a);a.attrs={cx:c,cy:d,r:e,fill:"none",stroke:"#000"};a.type="circle";G(f,a.attrs);return a},Za=function(a,c,d,e,f,m){var k=G("rect");a.canvas&&a.canvas.appendChild(k);a=new Q(k,a);a.attrs={x:c,y:d,width:e,height:f,r:m||0,rx:m||0,ry:m||0,fill:"none",
stroke:"#000"};a.type="rect";G(k,a.attrs);return a},$a=function(a,c,d,e,f){var m=G("ellipse");a.canvas&&a.canvas.appendChild(m);a=new Q(m,a);a.attrs={cx:c,cy:d,rx:e,ry:f,fill:"none",stroke:"#000"};a.type="ellipse";G(m,a.attrs);return a},ab=function(a,c,d,e,f,m){var k=G("image");G(k,{x:d,y:e,width:f,height:m,preserveAspectRatio:"none"});k.setAttributeNS(a.xlink,"href",c);a.canvas&&a.canvas.appendChild(k);a=new Q(k,a);a.attrs={x:d,y:e,width:f,height:m,src:c};a.type="image";return a},bb=function(a,c,
d,e){var f=G("text");G(f,{x:c,y:d,"text-anchor":"middle"});a.canvas&&a.canvas.appendChild(f);a=new Q(f,a);a.attrs={x:c,y:d,"text-anchor":"middle",text:e,font:ma.font,stroke:"none",fill:"#000"};a.type="text";fa(a,a.attrs);return a},cb=function(a,c){this.width=a||this.width;this.height=c||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},wa=function(){var a=Qa[q](0,arguments),c=a&&a.container,d=a.x,e=a.y,k=a.width,a=a.height;if(!c)throw Error("SVG container not found.");
var m=G("svg"),d=d||0,e=e||0,k=k||512,a=a||342;G(m,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:k,height:a});1==c?(m.style.cssText="position:absolute;left:"+d+"px;top:"+e+"px",g.body.appendChild(m)):c.firstChild?c.insertBefore(m,c.firstChild):c.appendChild(m);c=new f;c.width=k;c.height=a;c.canvas=m;Ba.call(c,c,h.fn);c.clear();return c};l.clear=function(){for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null;(this.desc=G("desc")).appendChild(g.createTextNode("Created with Rapha\u00ebl"));
a.appendChild(this.desc);a.appendChild(this.defs=G("defs"))};l.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=Va(a)}}if(h.vml){var db={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},ub=/([clmz]),?([^clmz]*)/gi,vb=/ progid:\S+Blur\([^\)]+\)/g,wb=/-?[^,\s-]+/g,ka=1E3+a+1E3,la={path:1,rect:1};h[da]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};Wa=function(a,
c){var d=W("group");d.style.cssText="position:absolute;left:0;top:0;width:"+c.width+"px;height:"+c.height+"px";d.coordsize=c.coordsize;d.coordorigin=c.coordorigin;var e=W("shape"),f=e.style;f.width=c.width+"px";f.height=c.height+"px";e.coordsize=ka;e.coordorigin=c.coordorigin;d.appendChild(e);e=new Q(e,d,c);f={fill:"none",stroke:"#000"};a&&(f.path=a);e.type="path";e.path=[];e.Path="";fa(e,f);c.canvas.appendChild(d);return e};fa=function(d,f){d.attrs=d.attrs||{};var l=d.node,j=d.attrs,q=l.style,m;
m=(f.x!=j.x||f.y!=j.y||f.width!=j.width||f.height!=j.height||f.r!=j.r)&&"rect"==d.type;for(var n in f)f[w](n)&&(j[n]=f[n]);m&&(j.path=eb(j.x,j.y,j.width,j.height,j.r),d.X=j.x,d.Y=j.y,d.W=j.width,d.H=j.height);f.href&&(l.href=f.href);f.title&&(l.title=f.title);f.target&&(l.target=f.target);f.cursor&&(q.cursor=f.cursor);"blur"in f&&d.blur(f.blur);if(f.path&&"path"==d.type||m){m=l;n=j.path;var y=/[ahqstv]/ig,E=ia;e(n).match(y)&&(E=qa);y=/[clmz]/g;if(E==ia&&!e(n).match(y))n=e(n).replace(ub,function(a,
c,d){var e=[],p="m"==s.call(c),f=db[c];d.replace(wb,function(a){p&&2==e[k]&&(f+=e+db["m"==c?"l":"L"],e=[]);e[R](I(10*a))});return f+e});else{var y=E(n),v;n=[];for(var z=0,C=y[k];z<C;z++){E=y[z];v=s.call(y[z][0]);"z"==v&&(v="x");for(var r=1,D=E[k];r<D;r++)v+=I(10*E[r])+(r!=D-1?",":"");n[R](v)}n=n[x](a)}m.path=n}null!=f.rotation&&d.rotate(f.rotation,!0);f.translation&&(m=e(f.translation).split(c),ta.call(d,m[0],m[1]),null!=d._.rt.cx&&(d._.rt.cx+=+m[0],d._.rt.cy+=+m[1],d.setBox(d.attrs,m[0],m[1])));
f.scale&&(m=e(f.scale).split(c),d.scale(+m[0]||1,+m[1]||+m[0]||1,+m[2]||null,+m[3]||null));"clip-rect"in f&&(m=e(f["clip-rect"]).split(c),4==m[k]&&(m[2]=+m[2]+ +m[0],m[3]=+m[3]+ +m[1],n=l.clipRect||g.createElement("div"),y=n.style,E=l.parentNode,y.clip=h.format("rect({1}px {2}px {3}px {0}px)",m),l.clipRect||(y.position="absolute",y.top=0,y.left=0,y.width=d.paper.width+"px",y.height=d.paper.height+"px",E.parentNode.insertBefore(n,E),n.appendChild(E),l.clipRect=n)),f["clip-rect"]||l.clipRect&&(l.clipRect.style.clip=
""));"image"==d.type&&f.src&&(l.src=f.src);"image"==d.type&&f.opacity&&(l.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+100*f.opacity+")",q.filter=(l.filterMatrix||"")+(l.filterOpacity||""));f.font&&(q.font=f.font);f["font-family"]&&(q.fontFamily='"'+f["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"');f["font-size"]&&(q.fontSize=f["font-size"]);f["font-weight"]&&(q.fontWeight=f["font-weight"]);f["font-style"]&&(q.fontStyle=f["font-style"]);if(null!=f.opacity||null!=
f["stroke-width"]||null!=f.fill||null!=f.stroke||null!=f["stroke-width"]||null!=f["stroke-opacity"]||null!=f["fill-opacity"]||null!=f["stroke-dasharray"]||null!=f["stroke-miterlimit"]||null!=f["stroke-linejoin"]||null!=f["stroke-linecap"]){l=d.shape||l;m=l.getElementsByTagName("fill")&&l.getElementsByTagName("fill")[0];n=!1;!m&&(n=m=W("fill"));if("fill-opacity"in f||"opacity"in f)q=((+j["fill-opacity"]+1||2)-1)*((+j.opacity+1||2)-1)*((+h.getRGB(f.fill).o+1||2)-1),q=M(u(q,0),1),m.opacity=q;f.fill&&
(m.on=!0);if(null==m.on||"none"==f.fill)m.on=!1;if(m.on&&f.fill)if(q=f.fill.match(T))m.src=q[1],m.type="tile";else if(m.color=h.getRGB(f.fill).hex,m.src="",m.type="solid",h.getRGB(f.fill).error&&(d.type in{circle:1,ellipse:1}||"r"!=e(f.fill).charAt())&&ja(d,f.fill))j.fill="none",j.gradient=f.fill;n&&l.appendChild(m);m=l.getElementsByTagName("stroke")&&l.getElementsByTagName("stroke")[0];n=!1;!m&&(n=m=W("stroke"));if(f.stroke&&"none"!=f.stroke||f["stroke-width"]||null!=f["stroke-opacity"]||f["stroke-dasharray"]||
f["stroke-miterlimit"]||f["stroke-linejoin"]||f["stroke-linecap"])m.on=!0;("none"==f.stroke||null==m.on||0==f.stroke||0==f["stroke-width"])&&(m.on=!1);q=h.getRGB(f.stroke);m.on&&f.stroke&&(m.color=q.hex);q=((+j["stroke-opacity"]+1||2)-1)*((+j.opacity+1||2)-1)*((+q.o+1||2)-1);y=0.75*(F(f["stroke-width"])||1);q=M(u(q,0),1);null==f["stroke-width"]&&(y=j["stroke-width"]);f["stroke-width"]&&(m.weight=y);y&&1>y&&(q*=y)&&(m.weight=1);m.opacity=q;f["stroke-linejoin"]&&(m.joinstyle=f["stroke-linejoin"]||"miter");
m.miterlimit=f["stroke-miterlimit"]||8;f["stroke-linecap"]&&(m.endcap="butt"==f["stroke-linecap"]?"flat":"square"==f["stroke-linecap"]?"square":"round");f["stroke-dasharray"]&&(q={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},m.dashstyle=q[w](f["stroke-dasharray"])?q[f["stroke-dasharray"]]:"");n&&l.appendChild(m)}if("text"==d.type)switch(q=d.paper.span.style,j.font&&(q.font=
j.font),j["font-family"]&&(q.fontFamily=j["font-family"]),j["font-size"]&&(q.fontSize=j["font-size"]),j["font-weight"]&&(q.fontWeight=j["font-weight"]),j["font-style"]&&(q.fontStyle=j["font-style"]),d.node.string&&(d.paper.span.innerHTML=e(d.node.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>")),d.W=j.w=d.paper.span.offsetWidth,d.H=j.h=d.paper.span.offsetHeight,d.X=j.x,d.Y=j.y+I(d.H/2),j["text-anchor"]){case "start":d.node.style["v-text-align"]="left";d.bbx=I(d.W/2);break;
case "end":d.node.style["v-text-align"]="right";d.bbx=-I(d.W/2);break;default:d.node.style["v-text-align"]="center"}};ja=function(c,d){c.attrs=c.attrs||{};var f,g="linear",h=".5 .5";c.attrs.gradient=d;d=e(d).replace(La,function(c,d,e){g="radial";d&&e&&(d=F(d),e=F(e),0.25<C(d-0.5,2)+C(e-0.5,2)&&(e=y.sqrt(0.25-C(d-0.5,2))*(2*(0.5<e)-1)+0.5),h=d+a+e);return""});d=d.split(/\s*\-\s*/);if("linear"==g){var m=d.shift(),m=-F(m);if(isNaN(m))return null}var l=Pa(d);if(!l)return null;c=c.shape||c.node;f=c.getElementsByTagName("fill")[0]||
W("fill");!f.parentNode&&c.appendChild(f);if(l[k]){f.on=!0;f.method="none";f.color=l[0].color;f.color2=l[l[k]-1].color;for(var j=[],q=0,v=l[k];q<v;q++)l[q].offset&&j[R](l[q].offset+a+l[q].color);f.colors&&(f.colors.value=j[k]?j[x]():"0% "+f.color);"radial"==g?(f.type="gradientradial",f.focus="100%",f.focussize=h,f.focusposition=h):(f.type="gradient",f.angle=(270-m)%360)}return 1};Q=function(a,c,d){this[0]=a;this.id=h._oid++;this.node=a;a.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=c;this.paper=
d;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&(d.top.next=this);d.top=this;this.next=null};P=Q[d];P.rotate=function(d,f,g){if(this.removed)return this;if(null==d)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][x](a):this._.rt.deg;d=e(d).split(c);d[k]-1&&(f=F(d[1]),g=F(d[2]));d=F(d[0]);null!=f?this._.rt.deg=d:this._.rt.deg+=d;null==g&&(f=null);this._.rt.cx=f;this._.rt.cy=g;this.setBox(this.attrs,f,g);this.Group.style.rotation=this._.rt.deg;return this};
P.setBox=function(a,c,d){if(this.removed)return this;var e=this.Group.style,f=this.shape&&this.shape.style||this.node.style;a=a||{};for(var m in a)a[w](m)&&(this.attrs[m]=a[m]);c=c||this._.rt.cx;d=d||this._.rt.cy;var k=this.attrs,g;switch(this.type){case "circle":a=k.cx-k.r;m=k.cy-k.r;g=k=2*k.r;break;case "ellipse":a=k.cx-k.rx;m=k.cy-k.ry;g=2*k.rx;k=2*k.ry;break;case "image":a=+k.x;m=+k.y;g=k.width||0;k=k.height||0;break;case "text":this.textpath.v=["m",I(k.x),", ",I(k.y-2),"l",I(k.x)+1,", ",I(k.y-
2)][x]("");a=k.x-I(this.W/2);m=k.y-this.H/2;g=this.W;k=this.H;break;case "rect":case "path":this.attrs.path?(k=ra(this.attrs.path),a=k.x,m=k.y,g=k.width,k=k.height):(m=a=0,g=this.paper.width,k=this.paper.height);break;default:m=a=0,g=this.paper.width,k=this.paper.height}c=(null==c?a+g/2:c)-this.paper.width/2;d=(null==d?m+k/2:d)-this.paper.height/2;var h;e.left!=(h=c+"px")&&(e.left=h);e.top!=(h=d+"px")&&(e.top=h);this.X=la[w](this.type)?-c:a;this.Y=la[w](this.type)?-d:m;this.W=g;this.H=k;la[w](this.type)?
(f.left!=(h=10*-c+"px")&&(f.left=h),f.top!=(h=10*-d+"px")&&(f.top=h)):"text"==this.type?(f.left!=(h=-c+"px")&&(f.left=h),f.top!=(h=-d+"px")&&(f.top=h)):(e.width!=(h=this.paper.width+"px")&&(e.width=h),e.height!=(h=this.paper.height+"px")&&(e.height=h),f.left!=(h=a-c+"px")&&(f.left=h),f.top!=(h=m-d+"px")&&(f.top=h),f.width!=(h=g+"px")&&(f.width=h),f.height!=(h=k+"px")&&(f.height=h))};P.hide=function(){!this.removed&&(this.Group.style.display="none");return this};P.show=function(){!this.removed&&(this.Group.style.display=
"block");return this};P.getBBox=function(){return this.removed?this:la[w](this.type)?ra(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};P.remove=function(){if(!this.removed){ga(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)delete this[a];this.removed=!0}};P.attr=function(a,c){if(this.removed)return this;if(null==a){var d={},f;for(f in this.attrs)this.attrs[w](f)&&
(d[f]=this.attrs[f]);this._.rt.deg&&(d.rotation=this.rotate());(1!=this._.sx||1!=this._.sy)&&(d.scale=this.scale());d.gradient&&"none"==d.fill&&(d.fill=d.gradient)&&delete d.gradient;return d}if(null==c&&h.is(a,"string"))return"translation"==a?ta.call(this):"rotation"==a?this.rotate():"scale"==a?this.scale():"fill"==a&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[a];if(this.attrs&&null==c&&h.is(a,X)){var g={};f=0;for(d=a[k];f<d;f++)g[a[f]]=this.attr(a[f]);return g}null!=
c&&(d={},d[a]=c);null==c&&h.is(a,"object")&&(d=a);if(d){for(g in this.paper.customAttributes)if(this.paper.customAttributes[w](g)&&d[w](g)&&h.is(this.paper.customAttributes[g],"function")){f=this.paper.customAttributes[g].apply(this,[].concat(d[g]));this.attrs[g]=d[g];for(var m in f)f[w](m)&&(d[m]=f[m])}d.text&&"text"==this.type&&(this.node.string=d.text);fa(this,d);d.gradient&&({circle:1,ellipse:1}[w](this.type)||"r"!=e(d.gradient).charAt())&&ja(this,d.gradient);(!la[w](this.type)||this._.rt.deg)&&
this.setBox(this.attrs)}return this};P.toFront=function(){!this.removed&&this.Group.parentNode.appendChild(this.Group);this.paper.top!=this&&Ra(this,this.paper);return this};P.toBack=function(){if(this.removed)return this;this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),Sa(this,this.paper));return this};P.insertAfter=function(a){if(this.removed)return this;a.constructor==Z&&(a=a[a.length-1]);a.Group.nextSibling?a.Group.parentNode.insertBefore(this.Group,
a.Group.nextSibling):a.Group.parentNode.appendChild(this.Group);Ta(this,a,this.paper);return this};P.insertBefore=function(a){if(this.removed)return this;a.constructor==Z&&(a=a[0]);a.Group.parentNode.insertBefore(this.Group,a.Group);Ua(this,a,this.paper);return this};P.blur=function(c){var d=this.node.runtimeStyle,e=d.filter,e=e.replace(vb,"");0!==+c?(this.attrs.blur=c,d.filter=e+a+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+c||1.5)+")",d.margin=h.format("-{0}px 0 0 -{0}px",I(+c||1.5))):
(d.filter=e,d.margin=0,delete this.attrs.blur)};var Ya=function(a,c,d,e){var f=W("group"),m=W("oval");f.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";f.coordsize=ka;f.coordorigin=a.coordorigin;f.appendChild(m);m=new Q(m,f,a);m.type="circle";fa(m,{stroke:"#000",fill:"none"});m.attrs.cx=c;m.attrs.cy=d;m.attrs.r=e;m.setBox({x:c-e,y:d-e,width:2*e,height:2*e});a.canvas.appendChild(f);return m},eb=function(a,c,d,e,f){return f?h.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",
a+f,c,d-2*f,f,-f,e-2*f,2*f-d,2*f-e):h.format("M{0},{1}l{2},0,0,{3},{4},0z",a,c,d,e,-d)},Za=function(a,c,d,e,f,m){var k=eb(c,d,e,f,m);a=a.path(k);var g=a.attrs;a.X=g.x=c;a.Y=g.y=d;a.W=g.width=e;a.H=g.height=f;g.r=m;g.path=k;a.type="rect";return a},$a=function(a,c,d,e,f){var m=W("group"),k=W("oval");m.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";m.coordsize=ka;m.coordorigin=a.coordorigin;m.appendChild(k);k=new Q(k,m,a);k.type="ellipse";fa(k,{stroke:"#000"});
k.attrs.cx=c;k.attrs.cy=d;k.attrs.rx=e;k.attrs.ry=f;k.setBox({x:c-e,y:d-f,width:2*e,height:2*f});a.canvas.appendChild(m);return k},ab=function(a,c,d,e,f,k){var g=W("group"),h=W("image");g.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";g.coordsize=ka;g.coordorigin=a.coordorigin;h.src=c;g.appendChild(h);h=new Q(h,g,a);h.type="image";h.attrs.src=c;h.attrs.x=d;h.attrs.y=e;h.attrs.w=f;h.attrs.h=k;h.setBox({x:d,y:e,width:f,height:k});a.canvas.appendChild(g);return h},
bb=function(a,c,d,f){var k=W("group"),m=W("shape"),g=m.style,l=W("path"),j=W("textpath");k.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";k.coordsize=ka;k.coordorigin=a.coordorigin;l.v=h.format("m{0},{1}l{2},{1}",I(10*c),I(10*d),I(10*c)+1);l.textpathok=!0;g.width=a.width;g.height=a.height;j.string=e(f);j.on=!0;m.appendChild(j);m.appendChild(l);k.appendChild(m);g=new Q(j,k,a);g.shape=m;g.textpath=l;g.type="text";g.attrs.text=f;g.attrs.x=c;g.attrs.y=d;g.attrs.w=
1;g.attrs.h=1;fa(g,{font:ma.font,stroke:"none",fill:"#000"});g.setBox();a.canvas.appendChild(k);return g},cb=function(a,c){var d=this.canvas.style;a==+a&&(a+="px");c==+c&&(c+="px");d.width=a;d.height=c;d.clip="rect(0 "+a+" "+c+" 0)";return this},W;g.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!g.namespaces.rvml&&g.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),W=function(a){return g.createElement("<rvml:"+a+' class="rvml">')}}catch(Db){W=function(a){return g.createElement("<"+
a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}wa=function(){var c=Qa[q](0,arguments),d=c.container,e=c.height,k=c.width,l=c.x,c=c.y;if(!d)throw Error("VML container not found.");var m=new f,j=m.canvas=g.createElement("div"),x=j.style,l=l||0,c=c||0,k=k||512,e=e||342;k==+k&&(k+="px");e==+e&&(e+="px");m.width=1E3;m.height=1E3;m.coordsize=1E4+a+1E4;m.coordorigin="0 0";m.span=g.createElement("span");m.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";
j.appendChild(m.span);x.cssText=h.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",k,e);1==d?(g.body.appendChild(j),x.left=l+"px",x.top=c+"px",x.position="absolute"):d.firstChild?d.insertBefore(j,d.firstChild):d.appendChild(j);Ba.call(m,m,h.fn);return m};l.clear=function(){this.canvas.innerHTML="";this.span=g.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";
this.canvas.appendChild(this.span);this.bottom=this.top=null};l.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=Va(a);return!0}}var fb=navigator.userAgent.match(/Version\\x2f(.*?)\s/);"Apple Computer, Inc."==navigator.vendor&&(fb&&4>fb[1]||"iP"==navigator.platform.slice(0,2))?l.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});N.setTimeout(function(){a.remove()})}:l.safari=function(){};var xb=function(){this.returnValue=
!1},yb=function(){return this.originalEvent.preventDefault()},zb=function(){this.cancelBubble=!0},Ab=function(){return this.originalEvent.stopPropagation()},gb;gb=g.addEventListener?function(a,c,d,e){var f=D&&L[c]?L[c]:c,k=function(f){if(D&&L[w](c))for(var k=0,m=f.targetTouches&&f.targetTouches.length;k<m;k++)if(f.targetTouches[k].target==a){m=f;f=f.targetTouches[k];f.originalEvent=m;f.preventDefault=yb;f.stopPropagation=Ab;break}return d.call(e,f)};a.addEventListener(f,k,!1);return function(){a.removeEventListener(f,
k,!1);return!0}}:g.attachEvent?function(a,c,d,e){var f=function(a){a=a||N.event;a.preventDefault=a.preventDefault||xb;a.stopPropagation=a.stopPropagation||zb;return d.call(e,a)};a.attachEvent("on"+c,f);return function(){a.detachEvent("on"+c,f);return!0}}:void 0;for(var ba=[],Da=function(a){for(var c=a.clientX,d=a.clientY,e=g.documentElement.scrollTop||g.body.scrollTop,f=g.documentElement.scrollLeft||g.body.scrollLeft,k,h=ba.length;h--;){k=ba[h];if(D)for(var l=a.touches.length,j;l--;){if(j=a.touches[l],
j.identifier==k.el._drag.id){c=j.clientX;d=j.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();c+=f;d+=e;k.move&&k.move.call(k.move_scope||k.el,c-k.el._drag.x,d-k.el._drag.y,c,d,a)}},Ea=function(a){h.unmousemove(Da).unmouseup(Ea);for(var c=ba.length,d;c--;)d=ba[c],d.el._drag={},d.end&&d.end.call(d.end_scope||d.start_scope||d.move_scope||d.el,a);ba=[]},hb=H[k];hb--;)(function(a){h[a]=Q[d][a]=function(c,d){h.is(c,"function")&&(this.events=this.events||[],this.events.push({name:a,
f:c,unbind:gb(this.shape||this.node||g,a,c,d||this)}));return this};h["un"+a]=Q[d]["un"+a]=function(c){for(var d=this.events,e=d[k];e--;)if(d[e].name==a&&d[e].f==c){d[e].unbind();d.splice(e,1);!d.length&&delete this.events;break}return this}})(H[hb]);P.hover=function(a,c,d,e){return this.mouseover(a,d).mouseout(c,e||d)};P.unhover=function(a,c){return this.unmouseover(a).unmouseout(c)};P.drag=function(a,c,d,e,f,k){this._drag={};this.mousedown(function(l){(l.originalEvent||l).preventDefault();var j=
g.documentElement.scrollTop||g.body.scrollTop,q=g.documentElement.scrollLeft||g.body.scrollLeft;this._drag.x=l.clientX+q;this._drag.y=l.clientY+j;this._drag.id=l.identifier;c&&c.call(f||e||this,l.clientX+q,l.clientY+j,l);!ba.length&&h.mousemove(Da).mouseup(Ea);ba.push({el:this,move:a,end:d,move_scope:e,start_scope:f,end_scope:k})});return this};P.undrag=function(a,c,d){for(c=ba.length;c--;)ba[c].el==this&&ba[c].move==a&&ba[c].end==d&&ba.splice(c++,1);!ba.length&&h.unmousemove(Da).unmouseup(Ea)};l.circle=
function(a,c,d){return Ya(this,a||0,c||0,d||0)};l.rect=function(a,c,d,e,f){return Za(this,a||0,c||0,d||0,e||0,f||0)};l.ellipse=function(a,c,d,e){return $a(this,a||0,c||0,d||0,e||0)};l.path=function(a){a&&!h.is(a,"string")&&!h.is(a[0],X)&&(a+="");return Wa(h.format[q](h,arguments),this)};l.image=function(a,c,d,e,f){return ab(this,a||"about:blank",c||0,d||0,e||0,f||0)};l.text=function(a,c,d){return bb(this,a||0,c||0,e(d))};l.set=function(a){1<arguments[k]&&(a=Array[d].splice.call(arguments,0,arguments[k]));
return new Z(a)};l.setSize=cb;l.top=l.bottom=null;l.raphael=h;P.resetScale=function(){if(this.removed)return this;this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};P.scale=function(c,d,e,f){if(this.removed)return this;if(null==c&&null==d)return{x:this._.sx,y:this._.sy,toString:j};d=d||c;!+d&&(d=c);var g,m,h=this.attrs;if(0!=c){var l=this.getBBox(),q=l.x+l.width/2,v=l.y+l.height/2;g=U(c/this._.sx);m=U(d/this._.sy);e=+e||0==e?e:q;f=+f||0==f?f:v;var n=0<this._.sx,s=0<this._.sy,l=~~(c/U(c)),w=~~(d/U(d)),
u=g*l,y=m*w,z=this.node.style,q=e+U(q-e)*u*(q>e==n?1:-1),v=f+U(v-f)*y*(v>f==s?1:-1),C=c*l>d*w?m:g;switch(this.type){case "rect":case "image":var r=h.width*g,D=h.height*m;this.attr({height:D,r:h.r*C,width:r,x:q-r/2,y:v-D/2});break;case "circle":case "ellipse":this.attr({rx:h.rx*g,ry:h.ry*m,r:h.r*C,cx:q,cy:v});break;case "text":this.attr({x:q,y:v});break;case "path":for(var C=Aa(h.path),N=!0,n=n?u:g,s=s?y:m,y=0,u=C[k];y<u;y++){var M=C[y],A=ea.call(M[0]);if(!("M"==A&&N))if(N=!1,"A"==A)M[C[y][k]-2]*=
n,M[C[y][k]-1]*=s,M[1]*=g,M[2]*=m,M[5]=+(l+w?!!+M[5]:!+M[5]);else if("H"==A)for(var A=1,S=M[k];A<S;A++)M[A]*=n;else if("V"==A){A=1;for(S=M[k];A<S;A++)M[A]*=s}else{A=1;for(S=M[k];A<S;A++)M[A]*=A%2?n:s}}m=ra(C);g=q-m.x-m.width/2;m=v-m.y-m.height/2;C[0][1]+=g;C[0][2]+=m;this.attr({path:C})}this.type in{text:1,image:1}&&(1!=l||1!=w)?this.transformations?(this.transformations[2]="scale(".concat(l,",",w,")"),this.node.setAttribute("transform",this.transformations[x](a)),g=-1==l?-h.x-(r||0):h.x,m=-1==w?
-h.y-(D||0):h.y,this.attr({x:g,y:m}),h.fx=l-1,h.fy=w-1):(this.node.filterMatrix=" progid:DXImageTransform.Microsoft"+".Matrix(M11=".concat(l,", M12=0, M21=0, M22=",w,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),z.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")):this.transformations?(this.transformations[2]="",this.node.setAttribute("transform",this.transformations[x](a)),h.fx=0,h.fy=0):(this.node.filterMatrix="",z.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||
""));h.scale=[c,d,e,f][x](a);this._.sx=c;this._.sy=d}return this};P.clone=function(){if(this.removed)return null;var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};var Fa={},ua=function(a,c,d,e,f,k,g,l,j){var q=0,x=100,n=[a,c,d,e,f,k,g,l].join(),s=Fa[n],w,u;!s&&(Fa[n]=s={data:[]});s.timer&&clearTimeout(s.timer);s.timer=setTimeout(function(){delete Fa[n]},2E3);null!=j&&(x=10*~~ua(a,c,d,e,f,k,g,l));for(var y=0;y<x+1;y++){s.data[j]>y?u=s.data[y*x]:(u=h.findDotsAtSegment(a,
c,d,e,f,k,g,l,y/x),s.data[y]=u);y&&(q+=C(C(w.x-u.x,2)+C(w.y-u.y,2),0.5));if(null!=j&&q>=j)return u;w=u}if(null==j)return q},Ga=function(a,c){return function(d,e,f){d=qa(d);for(var k,g,l,j,q="",s={},n=0,w=0,u=d.length;w<u;w++){l=d[w];if("M"==l[0])k=+l[1],g=+l[2];else{j=ua(k,g,l[1],l[2],l[3],l[4],l[5],l[6]);if(n+j>e){if(c&&!s.start){k=ua(k,g,l[1],l[2],l[3],l[4],l[5],l[6],e-n);q+=["C",k.start.x,k.start.y,k.m.x,k.m.y,k.x,k.y];if(f)return q;s.start=q;q=["M",k.x,k.y+"C",k.n.x,k.n.y,k.end.x,k.end.y,l[5],
l[6]][x]();n+=j;k=+l[5];g=+l[6];continue}if(!a&&!c)return k=ua(k,g,l[1],l[2],l[3],l[4],l[5],l[6],e-n),{x:k.x,y:k.y,alpha:k.alpha}}n+=j;k=+l[5];g=+l[6]}q+=l}s.end=q;k=a?n:c?s:h.findDotsAtSegment(k,g,l[1],l[2],l[3],l[4],l[5],l[6],1);k.alpha&&(k={x:k.x,y:k.y,alpha:k.alpha});return k}},ib=Ga(1),va=Ga(),Ha=Ga(0,1);P.getTotalLength=function(){if("path"==this.type)return this.node.getTotalLength?this.node.getTotalLength():ib(this.attrs.path)};P.getPointAtLength=function(a){if("path"==this.type)return va(this.attrs.path,
a)};P.getSubpath=function(a,c){if("path"==this.type){if("1e-6">U(this.getTotalLength()-c))return Ha(this.attrs.path,a).end;var d=Ha(this.attrs.path,c,1);return a?Ha(d,a).end:d}};h.easing_formulas={linear:function(a){return a},"<":function(a){return C(a,3)},">":function(a){return C(a-1,3)+1},"<>":function(a){a*=2;return 1>a?C(a,3)/2:(C(a-2,3)+2)/2},backIn:function(a){return a*a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){return 0==a||1==a?a:C(2,
-10*a)*y.sin((a-0.075)*2*S/0.3)+1},bounce:function(a){a<1/2.75?a*=7.5625*a:a<2/2.75?(a-=1.5/2.75,a=7.5625*a*a+0.75):a<2.5/2.75?(a-=2.25/2.75,a=7.5625*a*a+0.9375):(a-=2.625/2.75,a=7.5625*a*a+0.984375);return a}};var ca=[],jb=function(){for(var c=+new Date,d=0;d<ca[k];d++){var e=ca[d];if(!e.stop&&!e.el.removed){var f=c-e.start,g=e.ms,m=e.easing,l=e.from,j=e.diff,q=e.to,n=e.t,s=e.el,e={},u;if(f<g){var f=m(f/g),y;for(y in l)if(l[w](y)){switch(xa[y]){case "along":u=f*g*j[y];q.back&&(u=q.len-u);m=va(q[y],
u);s.translate(j.sx-j.x||0,j.sy-j.y||0);j.x=m.x;j.y=m.y;s.translate(m.x-j.sx,m.y-j.sy);q.rot&&s.rotate(j.r+m.alpha,m.x,m.y);break;case V:u=+l[y]+f*g*j[y];break;case "colour":u="rgb("+[Ia(I(l[y].r+f*g*j[y].r)),Ia(I(l[y].g+f*g*j[y].g)),Ia(I(l[y].b+f*g*j[y].b))][x](",")+")";break;case "path":u=[];for(var m=0,z=l[y][k];m<z;m++){u[m]=[l[y][m][0]];for(var C=1,r=l[y][m][k];C<r;C++)u[m][C]=+l[y][m][C]+f*g*j[y][m][C];u[m]=u[m][x](a)}u=u[x](a);break;case "csv":switch(y){case "translation":u=f*g*j[y][0]-n.x;
m=f*g*j[y][1]-n.y;n.x+=u;n.y+=m;u=u+a+m;break;case "rotation":u=+l[y][0]+f*g*j[y][0];l[y][1]&&(u+=","+l[y][1]+","+l[y][2]);break;case "scale":u=[+l[y][0]+f*g*j[y][0],+l[y][1]+f*g*j[y][1],2 in q[y]?q[y][2]:"",3 in q[y]?q[y][3]:""][x](a);break;case "clip-rect":u=[];for(m=4;m--;)u[m]=+l[y][m]+f*g*j[y][m]}break;default:z=[].concat(l[y]);u=[];for(m=s.paper.customAttributes[y].length;m--;)u[m]=+z[m]+f*g*j[y][m]}e[y]=u}s.attr(e);s._run&&s._run.call(s)}else q.along&&(m=va(q.along,q.len*!q.back),s.translate(j.sx-
(j.x||0)+m.x-j.sx,j.sy-(j.y||0)+m.y-j.sy),q.rot&&s.rotate(j.r+m.alpha,m.x,m.y)),(n.x||n.y)&&s.translate(-n.x,-n.y),q.scale&&(q.scale+=""),s.attr(q),ca.splice(d--,1)}}h.svg&&s&&s.paper&&s.paper.safari();ca[k]&&setTimeout(jb)},Bb=function(a,c,d,e,f){var k=d-e;c.timeouts.push(setTimeout(function(){h.is(f,"function")&&f.call(c);c.animate(a,k,a.easing)},e))},Ia=function(a){return u(M(a,255),0)},ta=function(a,c){if(null==a)return{x:this._.tx,y:this._.ty,toString:j};this._.tx+=+a;this._.ty+=+c;switch(this.type){case "circle":case "ellipse":this.attr({cx:+a+
this.attrs.cx,cy:+c+this.attrs.cy});break;case "rect":case "image":case "text":this.attr({x:+a+this.attrs.x,y:+c+this.attrs.y});break;case "path":var d=Aa(this.attrs.path);d[0][1]+=+a;d[0][2]+=+c;this.attr({path:d})}return this};P.animateWith=function(a,c,d,e,f){for(var k=0,g=ca.length;k<g;k++)ca[k].el.id==a.id&&(c.start=ca[k].start);return this.animate(c,d,e,f)};P.animateAlong=A();P.animateAlongBack=A(1);P.onAnimation=function(a){this._run=a||0;return this};P.animate=function(a,d,f,g){var l=this;
l.timeouts=l.timeouts||[];if(h.is(f,"function")||!f)g=f||null;if(l.removed)return g&&g.call(l),l;var m={},j={},q=!1,x={},s;for(s in a)if(a[w](s)&&(xa[w](s)||l.paper.customAttributes[w](s)))switch(q=!0,m[s]=l.attr(s),null==m[s]&&(m[s]=ma[s]),j[s]=a[s],xa[s]){case "along":var n=ib(a[s]),u=va(a[s],n*!!a.back),y=l.getBBox();x[s]=n/d;x.tx=y.x;x.ty=y.y;x.sx=u.x;x.sy=u.y;j.rot=a.rot;j.back=a.back;j.len=n;a.rot&&(x.r=F(l.rotate())||0);break;case V:x[s]=(j[s]-m[s])/d;break;case "colour":m[s]=h.getRGB(m[s]);
n=h.getRGB(j[s]);x[s]={r:(n.r-m[s].r)/d,g:(n.g-m[s].g)/d,b:(n.b-m[s].b)/d};break;case "path":n=qa(m[s],j[s]);m[s]=n[0];y=n[1];x[s]=[];n=0;for(u=m[s][k];n<u;n++){x[s][n]=[0];for(var z=1,C=m[s][n][k];z<C;z++)x[s][n][z]=(y[n][z]-m[s][n][z])/d}break;case "csv":u=e(a[s]).split(c);y=e(m[s]).split(c);switch(s){case "translation":m[s]=[0,0];x[s]=[u[0]/d,u[1]/d];break;case "rotation":m[s]=y[1]==u[1]&&y[2]==u[2]?y:[0,u[1],u[2]];x[s]=[(u[0]-m[s][0])/d,0,0];break;case "scale":a[s]=u;m[s]=e(m[s]).split(c);x[s]=
[(u[0]-m[s][0])/d,(u[1]-m[s][1])/d,0,0];break;case "clip-rect":m[s]=e(m[s]).split(c);x[s]=[];for(n=4;n--;)x[s][n]=(u[n]-m[s][n])/d}j[s]=u;break;default:u=[].concat(a[s]);y=[].concat(m[s]);x[s]=[];for(n=l.paper.customAttributes[s][k];n--;)x[s][n]=((u[n]||0)-(y[n]||0))/d}if(q){s=h.easing_formulas[f];if(!s)if((s=e(f).match(Y))&&5==s[k]){var r=s;s=function(a){var c=+r[1],e=+r[2],f=3*c,k=3*(+r[3]-c)-f,g=1-f-k,c=3*e,e=3*(+r[4]-e)-c,l=1-c-e;a=function(a,c){var d,e,l,m;l=a;for(e=0;8>e;e++){m=((g*l+k)*l+f)*
l-a;if(U(m)<c)return l;d=(3*g*l+2*k)*l+f;if(1E-6>U(d))break;l-=m/d}d=0;e=1;l=a;if(l<d)return d;if(l>e)return e;for(;d<e;){m=((g*l+k)*l+f)*l;if(U(m-a)<c)break;a>m?d=l:e=l;l=(e-d)/2+d}return l}(a,1/(200*d));return((l*a+e)*a+c)*a}}else s=function(a){return a};ca.push({start:a.start||+new Date,ms:d,easing:s,from:m,diff:x,to:j,el:l,t:{x:0,y:0}});h.is(g,"function")&&(l._ac=setTimeout(function(){g.call(l)},d));1==ca[k]&&setTimeout(jb)}else{f=[];var M,D;for(D in a)a[w](D)&&lb.test(D)&&(s={value:a[D]},"from"==
D&&(D=0),"to"==D&&(D=100),s.key=aa(D,10),f.push(s));f.sort(qb);f[0].key&&f.unshift({key:0,value:l.attrs});n=0;for(u=f[k];n<u;n++)Bb(f[n].value,l,d/100*f[n].key,d/100*(f[n-1]&&f[n-1].key||0),f[n-1]&&f[n-1].value.callback);(M=f[f[k]-1].value.callback)&&l.timeouts.push(setTimeout(function(){M.call(l)},d))}return this};P.stop=function(){for(var a=0;a<ca.length;a++)ca[a].el.id==this.id&&ca.splice(a--,1);a=0;for(ii=this.timeouts&&this.timeouts.length;a<ii;a++)clearTimeout(this.timeouts[a]);this.timeouts=
[];clearTimeout(this._ac);delete this._ac;return this};P.translate=function(a,c){return this.attr({translation:a+" "+c})};P[da]=function(){return"Rapha\u00ebl\u2019s object"};h.ae=ca;var Z=function(a){this.items=[];this[k]=0;this.type="set";if(a)for(var c=0,d=a[k];c<d;c++)if(a[c]&&(a[c].constructor==Q||a[c].constructor==Z))this[this.items[k]]=this.items[this.items[k]]=a[c],this[k]++};Z[d][R]=function(){for(var a,c,d=0,e=arguments[k];d<e;d++)if((a=arguments[d])&&(a.constructor==Q||a.constructor==Z))c=
this.items[k],this[c]=this.items[c]=a,this[k]++;return this};Z[d].pop=function(){delete this[this[k]--];return this.items.pop()};for(var Ja in P)P[w](Ja)&&(Z[d][Ja]=function(a){return function(){for(var c=0,d=this.items[k];c<d;c++)this.items[c][a][q](this.items[c],arguments);return this}}(Ja));Z[d].attr=function(a,c){if(a&&h.is(a,X)&&h.is(a[0],"object"))for(var d=0,e=a[k];d<e;d++)this.items[d].attr(a[d]);else{d=0;for(e=this.items[k];d<e;d++)this.items[d].attr(a,c)}return this};Z[d].animate=function(a,
c,d,e){(h.is(d,"function")||!d)&&(e=d||null);var f=this.items[k],l=f,g,j=this,s;e&&(s=function(){!--f&&e.call(j)});d=h.is(d,"string")?d:s;for(g=this.items[--l].animate(a,c,d,s);l--;)this.items[l]&&!this.items[l].removed&&this.items[l].animateWith(g,a,c,d,s);return this};Z[d].insertAfter=function(a){for(var c=this.items[k];c--;)this.items[c].insertAfter(a);return this};Z[d].getBBox=function(){for(var a=[],c=[],d=[],e=[],f=this.items[k];f--;){var l=this.items[f].getBBox();a[R](l.x);c[R](l.y);d[R](l.x+
l.width);e[R](l.y+l.height)}a=M[q](0,a);c=M[q](0,c);return{x:a,y:c,width:u[q](0,d)-a,height:u[q](0,e)-c}};Z[d].clone=function(a){a=new Z;for(var c=0,d=this.items[k];c<d;c++)a[R](this.items[c].clone());return a};h.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var c={w:a.w,face:{},glyphs:{}},d=a.face["font-family"],e;for(e in a.face)a.face[w](e)&&(c.face[e]=a.face[e]);this.fonts[d]?this.fonts[d][R](c):this.fonts[d]=[c];if(!a.svg){c.face["units-per-em"]=aa(a.face["units-per-em"],
10);for(var f in a.glyphs)if(a.glyphs[w](f)&&(d=a.glyphs[f],c.glyphs[f]={w:d.w,k:{},d:d.d&&"M"+d.d.replace(/[mlcxtrv]/g,function(a){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[a]||"M"})+"z"},d.k))for(var k in d.k)d[w](k)&&(c.glyphs[f].k[k]=d.k[k])}return a};l.getFont=function(a,c,d,e){e=e||"normal";d=d||"normal";c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(h.fonts){var f=h.fonts[a];if(!f){a=RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var l in h.fonts)if(h.fonts[w](l)&&
a.test(l)){f=h.fonts[l];break}}var g;if(f){l=0;for(a=f[k];l<a&&!(g=f[l],g.face["font-weight"]==c&&(g.face["font-style"]==d||!g.face["font-style"])&&g.face["font-stretch"]==e);l++);}return g}};l.print=function(a,d,f,l,g,m,j){m=m||"middle";j=u(M(j||0,1),-1);var s=this.set(),q=e(f).split(""),n=0;h.is(l,f)&&(l=this.getFont(l));if(l){f=(g||16)/l.face["units-per-em"];var x=l.face.bbox.split(c);g=+x[0];m=+x[1]+("baseline"==m?x[3]-x[1]+ +l.face.descent:(x[3]-x[1])/2);for(var x=0,w=q[k];x<w;x++){var y=x&&
l.glyphs[q[x-1]]||{},z=l.glyphs[q[x]],n=n+(x?(y.w||l.w)+(y.k&&y.k[q[x]]||0)+l.w*j:0);z&&z.d&&s[R](this.path(z.d).attr({fill:"#000",stroke:"none",translation:[n,0]}))}s.scale(f,f,g,m).translate(a-g,d-m)}return s};h.format=function(a,c){var d=h.is(c,X)?[0].concat(c):arguments;a&&h.is(a,"string")&&d[k]-1&&(a=a.replace(z,function(a,c){return null==d[++c]?"":d[c]}));return a||""};h.ninja=function(){J?N.Raphael=K:delete Raphael;return h};h.el=P;h.st=Z[d];J?N.Raphael=h:Raphael=h})();(function(){function h(a){return(a+"").replace(D,"")}function B(a,c,d){for(var e=a.length;e<c;e++)a=d?"0"+a:a+"0";return a}function r(a){return"[object Array]"===L.call(a)}function j(a,c){if(a.indexOf)return a.indexOf(c);for(var d=0,e=a.length;d<e;d++)if(a[d]===c)return d;return-1}function A(a,c,d){var e=c["-"];c=c["+"];var f;switch(d){case "n -":e=" "+e,c=" "+c;case "n-":a.substr(a.length-e.length)===e?f=["-",a.substr(0,a.length-e.length)]:a.substr(a.length-c.length)===c&&(f=["+",a.substr(0,a.length-
c.length)]);break;case "- n":e+=" ",c+=" ";case "-n":0===a.indexOf(e)?f=["-",a.substr(e.length)]:0===a.indexOf(c)&&(f=["+",a.substr(c.length)]);break;case "(n)":0===a.indexOf("(")&&")"===a.substr(a.length-1)&&(f=["-",a.substr(1,a.length-2)])}return f||["",a]}function c(a,c){if(!c)return 0;for(var d,e=a.getTime(),f=0,l=c.length;f<l;f++)if(d=c[f].start,null===d||e>=d)return f;return 0}function n(a){return a.split("\u00a0").join(" ").toUpperCase()}function z(a){for(var c=[],d=0,e=a.length;d<e;d++)c[d]=
n(a[d]);return c}function d(a,c,d,e){a=a.getFullYear();!e&&c.eras&&(a-=c.eras[d].offset);return a}function w(a,c){for(var d=0,e=!1,f=0,l=a.length;f<l;f++){var g=a.charAt(f);switch(g){case "'":e?c.push("'"):d++;e=!1;break;case "\\":e&&c.push("\\");e=!e;break;default:c.push(g),e=!1}}return d}function g(a,c){c=c||"F";var d;d=a.patterns;var e=c.length;if(1===e){d=d[c];if(!d)throw"Invalid date format string '"+c+"'.";c=d}else 2===e&&"%"===c.charAt(0)&&(c=c.charAt(1));return c}function N(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}
function J(a,e,f){a=h(a);f=f.calendar;a:{var l=f._parseRegExp;if(l){var q=l[e];if(q){e=q;break a}}else f._parseRegExp=l={};for(var q=g(f,e).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),r=["^"],D=[],C=0,A=0,K=N(),B;null!==(B=K.exec(q));){var H=q.slice(C,B.index),C=K.lastIndex,A=A+w(H,r);if(A%2)r.push(B[0]);else{var H=B[0],J=H.length;switch(H){case "dddd":case "ddd":case "MMMM":case "MMM":case "gg":case "g":H="(\\D+)";break;case "tt":case "t":H="(\\D*)";break;case "yyyy":case "fff":case "ff":case "f":H=
"(\\d{"+J+"})";break;case "dd":case "d":case "MM":case "M":case "yy":case "y":case "HH":case "H":case "hh":case "h":case "mm":case "m":case "ss":case "s":H="(\\d\\d?)";break;case "zzz":H="([+-]?\\d\\d?:\\d{2})";break;case "zz":case "z":H="([+-]?\\d\\d?)";break;case "/":H="(\\"+f["/"]+")";break;default:throw"Invalid date format pattern '"+H+"'.";}H&&r.push(H);D.push(B[0])}}w(q.slice(C),r);r.push("$");q={regExp:r.join("").replace(/\s+/g,"\\s+"),groups:D};e=l[e]=q}A=RegExp(e.regExp).exec(a);if(null===
A)return null;var K=e.groups,L=a=null,T=null,$=e=null,D=r=q=l=0;B=null;C=!1;H=0;for(J=K.length;H<J;H++){var O=A[H+1];if(O){var Y=K[H],I=Y.length,F=parseInt(O,10);switch(Y){case "dd":case "d":e=F;if(1>e||31<e)return null;break;case "MMM":case "MMMM":var T=f,I=3===I,Y=T.months,aa=T.monthsGenitive||T.months,ea=T._upperMonths,F=T._upperMonthsGen;ea||(T._upperMonths=ea=[z(Y.names),z(Y.namesAbbr)],T._upperMonthsGen=F=[z(aa.names),z(aa.namesAbbr)]);O=n(O);T=j(I?ea[1]:ea[0],O);0>T&&(T=j(I?F[1]:F[0],O));if(0>
T||11<T)return null;break;case "M":case "MM":T=F-1;if(0>T||11<T)return null;break;case "y":case "yy":case "yyyy":4>I?(L=f,O=F,F=new Date,Y=c(F),100>O&&(I=L.twoDigitYearMax,I="string"===typeof I?(new Date).getFullYear()%100+parseInt(I,10):I,L=d(F,L,Y),O+=L-L%100,O>I&&(O-=100)),L=O):L=F;if(0>L||9999<L)return null;break;case "h":case "hh":l=F;12===l&&(l=0);if(0>l||11<l)return null;break;case "H":case "HH":l=F;if(0>l||23<l)return null;break;case "m":case "mm":q=F;if(0>q||59<q)return null;break;case "s":case "ss":r=
F;if(0>r||59<r)return null;break;case "tt":case "t":C=f.PM&&(O===f.PM[0]||O===f.PM[1]||O===f.PM[2]);if(!C&&(!f.AM||O!==f.AM[0]&&O!==f.AM[1]&&O!==f.AM[2]))return null;break;case "f":case "ff":case "fff":D=F*Math.pow(10,3-I);if(0>D||999<D)return null;break;case "ddd":case "dddd":$=O;O=3===I;F=void 0;F=f.days;I=f._upperDays;I||(f._upperDays=I=[z(F.names),z(F.namesAbbr),z(F.namesShort)]);$=n($);O?(F=j(I[1],$),-1===F&&(F=j(I[2],$))):F=j(I[0],$);$=F;if(0>$||6<$)return null;break;case "zzz":I=O.split(/:/);
if(2!==I.length)return null;B=parseInt(I[0],10);if(-12>B||13<B)return null;I=parseInt(I[1],10);if(0>I||59<I)return null;B=60*B+(0===O.indexOf("-")?-I:I);break;case "z":case "zz":B=F;if(-12>B||13<B)return null;B*=60;break;case "g":case "gg":if(!O||!f.eras)return null;O=h(O.toLowerCase());I=0;for(F=f.eras.length;I<F;I++)if(O===f.eras[I].name.toLowerCase()){a=I;break}if(null===a)return null}}}A=new Date;K=(H=f.convert)?H.fromGregorian(A)[0]:A.getFullYear();null===L?L=K:f.eras&&(L+=f.eras[a||0].offset);
null===T&&(T=0);null===e&&(e=1);if(H){if(A=H.toGregorian(L,T,e),null===A)return null}else if(A.setFullYear(L,T,e),A.getDate()!==e||null!==$&&A.getDay()!==$)return null;C&&12>l&&(l+=12);A.setHours(l,q,r,D);null!==B&&(f=A.getMinutes()-(B+A.getTimezoneOffset()),A.setHours(A.getHours()+parseInt(f/60,10),f%60));return A}function K(a,e,f){function l(a,c){var d;d=a+"";return 1<c&&d.length<c?(d=A[c-2]+d,d.substr(d.length-c,c)):d}function h(){if(H||B)return H;H=L.test(e);B=!0;return H}function j(a,c){if(Y)return Y[c];
switch(c){case 0:return a.getFullYear();case 1:return a.getMonth();case 2:return a.getDate()}}var q=f.calendar,n=q.convert;if(!e||!e.length||"i"===e){if(f&&f.name.length)if(n)f=K(a,q.patterns.F,f);else{f=new Date(a.getTime());var z=c(a,q.eras);f.setFullYear(d(a,q,z));f=f.toLocaleString()}else f=a.toString();return f}var z=q.eras,r="s"===e;e=g(q,e);f=[];var D,A=["0","00","000"],H,B,L=/([^d]|^)(d|dd)([^d]|$)/g,J=0,O=N(),Y;for(!r&&n&&(Y=n.fromGregorian(a));;){D=O.lastIndex;n=O.exec(e);D=e.slice(D,n?
n.index:e.length);J+=w(D,f);if(!n)break;if(J%2)f.push(n[0]);else switch(D=n[0],n=D.length,D){case "ddd":case "dddd":f.push((3===n?q.days.namesAbbr:q.days.names)[a.getDay()]);break;case "d":case "dd":H=!0;f.push(l(j(a,2),n));break;case "MMM":case "MMMM":D=j(a,1);f.push(q.monthsGenitive&&h()?q.monthsGenitive[3===n?"namesAbbr":"names"][D]:q.months[3===n?"namesAbbr":"names"][D]);break;case "M":case "MM":f.push(l(j(a,1)+1,n));break;case "y":case "yy":case "yyyy":D=Y?Y[0]:d(a,q,c(a,z),r);4>n&&(D%=100);
f.push(l(D,n));break;case "h":case "hh":D=a.getHours()%12;0===D&&(D=12);f.push(l(D,n));break;case "H":case "HH":f.push(l(a.getHours(),n));break;case "m":case "mm":f.push(l(a.getMinutes(),n));break;case "s":case "ss":f.push(l(a.getSeconds(),n));break;case "t":case "tt":D=12>a.getHours()?q.AM?q.AM[0]:" ":q.PM?q.PM[0]:" ";f.push(1===n?D.charAt(0):D);break;case "f":case "ff":case "fff":f.push(l(a.getMilliseconds(),3).substr(0,n));break;case "z":case "zz":D=a.getTimezoneOffset()/60;f.push((0>=D?"+":"-")+
l(Math.floor(Math.abs(D)),n));break;case "zzz":D=a.getTimezoneOffset()/60;f.push((0>=D?"+":"-")+l(Math.floor(Math.abs(D)),2)+":"+l(Math.abs(a.getTimezoneOffset()%60),2));break;case "g":case "gg":q.eras&&f.push(q.eras[c(a,z)].name);break;case "/":f.push(q["/"]);break;default:throw"Invalid date format pattern '"+D+"'.";}}return f.join("")}var f={},l={en:{}};l["default"]=l.en;f.extend=function(a){for(var c=arguments[1]||{},d=2,e=arguments.length;d<e;d++){var f=arguments[d];if(f)for(var l in f){var g=
f[l];if("undefined"!==typeof g)if(a&&("[object Object]"===L.call(g)||r(g))){var h=c[l],h=h&&("[object Object]"===L.call(h)||r(h))?h:r(g)?[]:{};c[l]=this.extend(!0,h,g)}else c[l]=g}}return c};f.findClosestCulture=function(a){var c;if(!a)return this.culture||this.cultures["default"];"[object String]"===L.call(a)&&(a=a.split(","));if(r(a)){var d,e=this.cultures,f=a,l,g=f.length,j=[];for(l=0;l<g;l++)a=h(f[l]),a=a.split(";"),d=h(a[0]),1===a.length?a=1:(a=h(a[1]),0===a.indexOf("q=")?(a=a.substr(2),a=parseFloat(a,
10),a=isNaN(a)?0:a):a=1),j.push({lang:d,pri:a});j.sort(function(a,c){return a.pri<c.pri?1:-1});for(l=0;l<g;l++)if(d=j[l].lang,c=e[d])return c;for(l=0;l<g;l++){d=j[l].lang;do{f=d.lastIndexOf("-");if(-1===f)break;d=d.substr(0,f);if(c=e[d])return c}while(1)}for(l=0;l<g;l++){d=j[l].lang;for(var q in e)if(f=e[q],f.language==d)return f}}else if("object"===typeof a)return a;return c||null};f.preferCulture=function(a){this.culture=this.findClosestCulture(a)||this.cultures["default"]};f.localize=function(a,
c,d){"string"!==typeof c&&(c=this.culture.name||this.culture||"default");c=this.cultures[c]||{name:c};var e=l[c.name];3===arguments.length?(e||(e=l[c.name]={}),e[a]=d):(e&&(d=e[a]),"undefined"===typeof d&&((e=l[c.language])&&(d=e[a]),"undefined"===typeof d&&(d=l["default"][a])));return"undefined"===typeof d?null:d};f.format=function(a,c,d){d=this.findClosestCulture(d);if("number"===typeof a){var e=a;if(!c||"i"===c)a=d.name.length?e.toLocaleString():e.toString();else{c=c||"D";d=d.numberFormat;a=Math.abs(e);
var f=-1;1<c.length&&(f=parseInt(c.slice(1),10));var l=c.charAt(0).toUpperCase(),g;switch(l){case "D":c="n";-1!==f&&(a=B(""+a,f,!0));0>e&&(a=-a);break;case "N":g=d;case "C":g=g||d.currency;case "P":g=g||d.percent;c=0>e?g.pattern[0]:g.pattern[1]||"n";-1===f&&(f=g.decimals);b:{var h=a*("P"===l?100:1),l=g;g=l.groupSizes;a=g[0];var e=1,j=Math.pow(10,f),j=Math.round(h*j)/j;isFinite(j)||(j=h);var h=j+"",j="",j=h.split(/e/i),q=1<j.length?parseInt(j[1],10):0,h=j[0],j=h.split("."),h=j[0],j=1<j.length?j[1]:
"";0<q?(j=B(j,q,!1),h+=j.slice(0,q),j=j.substr(q)):0>q&&(q=-q,h=B(h,q+1),j=h.slice(-q,h.length)+j,h=h.slice(0,-q));j=0<f?l["."]+(j.length>f?j.slice(0,f):B(j,f)):"";f=h.length-1;l=l[","];for(q="";0<=f;){if(0===a||a>f){a=h.slice(0,f+1)+(q.length?l+q+j:j);break b}q=h.slice(f-a+1,f+1)+(q.length?l+q:"");f-=a;e<g.length&&(a=g[e],e++)}a=h.slice(0,f+1)+l+q+j}break;default:throw"Bad number format specifier: "+l;}g=/n|\$|-|%/g;for(e="";;){f=g.lastIndex;l=g.exec(c);e+=c.slice(f,l?l.index:c.length);if(!l)break;
switch(l[0]){case "n":e+=a;break;case "$":e+=d.currency.symbol;break;case "-":/[1-9]/.test(a)&&(e+=d["-"]);break;case "%":e+=d.percent.symbol}}a=e}}else a instanceof Date&&(a=K(a,c,d));return a};f.parseInt=function(a,c,d){return Math.floor(this.parseFloat(a,c,d))};f.parseFloat=function(c,d,f){"string"===typeof d&&(f=d,d=10);f=this.findClosestCulture(f);var l=NaN,g=f.numberFormat;-1<c.indexOf(f.numberFormat.currency.symbol)&&(c=c.replace(f.numberFormat.currency.symbol,""),c=c.replace(f.numberFormat.currency["."],
f.numberFormat["."]));c=h(c);if(a.test(c))l=parseFloat(c,d);else if(!d&&e.test(c))l=parseInt(c,16);else{f=A(c,g,g.pattern[0]);d=f[0];f=f[1];""===d&&"-n"!==g.pattern[0]&&(f=A(c,g,"-n"),d=f[0],f=f[1]);d=d||"+";var j;c=f.indexOf("e");0>c&&(c=f.indexOf("E"));0>c?(j=f,c=null):(j=f.substr(0,c),c=f.substr(c+1));var q=g["."],n=j.indexOf(q);0>n?(f=j,j=null):(f=j.substr(0,n),j=j.substr(n+q.length));q=g[","];f=f.split(q).join("");n=q.replace(/\u00A0/g," ");q!==n&&(f=f.split(n).join(""));d+=f;null!==j&&(d+="."+
j);null!==c&&(g=A(c,g,"-n"),d+="e"+(g[0]||"+")+g[1]);H.test(d)&&(l=parseFloat(d))}return l};f.parseDate=function(a,c,d){d=this.findClosestCulture(d);var e,f;if(c){if("string"===typeof c&&(c=[c]),c.length){f=0;for(var l=c.length;f<l;f++){var g=c[f];if(g&&(e=J(a,g,d)))break}}}else for(f in c=d.calendar.patterns,c)if(e=J(a,c[f],d))break;return e||null};var q=f.cultures=f.cultures||{},q=q["default"]=q.en=f.extend(!0,{name:"en",englishName:"English",nativeName:"English",isRTL:!1,language:"en",numberFormat:{pattern:["-n"],
decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),namesAbbr:"Sun Mon Tue Wed Thu Fri Sat".split(" "),namesShort:"Su Mo Tu We Th Fr Sa".split(" ")},months:{names:"January February March April May June July August September October November December ".split(" "),
namesAbbr:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec ".split(" ")},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}}},q.en);q.calendar=q.calendar||q.calendars.standard;var D=/^\s+|\s+$/g,a=/^[+-]?infinity$/i,e=/^0x[a-f0-9]+$/i,H=/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,
L=Object.prototype.toString;jQuery.global=f})();/*

 jQuery Tiny Pub/Sub - v0.3pre - 11/4/2010
 http://benalman.com/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/
*/
(function(h){var B=h({});h.subscribe=function(){B.bind.apply(B,arguments)};h.unsubscribe=function(){B.unbind.apply(B,arguments)};h.publish=function(){B.trigger.apply(B,arguments)}})(jQuery);/*
 
 copyright 2011, Mnemograph LLC
 Timeglider for Javascript / jQuery 
 http://timeglider.com/jquery

 Licensed under the MIT open source license
 http://timeglider.com/jquery/?p=license

*/
var timeglider=window.timeglider={version:"0.1.0"};
(function(h){h=timeglider;var B=jQuery,r={},j={},A={},c={},n={};h.TG_Date=function(c,j){var g,h,n;"number"==typeof c?(g=h=z.getDateFromSec(c),n=c):("today"==c&&(c=z.getToday()),g=h=c);var r;r=jQuery.trim(g);reg=RegExp(/[T0-9-: ]/);r=reg.test(r)?r:!1;if(!1===r)return{error:"Invalid date"};g=g.replace(",","");"-"==g.substr(0,1)?(this.bce=1,g=g.substr(1)):this.bce=0;g=g.replace(/[^0-9]/g,"-");g=g.split("-");this.ye=0===this.bce?parseInt(g[0],10):-1*parseInt(g[0],10);this.mo=parseInt(g[1],10);r=this.mo;
var f=this.ye;r=0<f?12*(f-1)+r:-1*(12*(Math.abs(f)-1)+(12-(r-1)));this.mo_num=r;this.da=parseInt(g[2],10);this.ho=parseInt(g[3],10)||0;this.mi=parseInt(g[4],10)||0;this.se=parseInt(g[5],10)||0;this.rd=z.getRataDie(this);n||(n=86400*Math.abs(this.rd),g=3600*this.ho,r=60*(this.mi-1),f=1,0>this.rd&&(f=-1),n=f*(n+g+r));this.sec=n;this.date_display=j?j.toLowerCase().substr(0,2):"";this.jsDate=new Date(this.ye,this.mo-1,this.da,this.ho,this.mi,this.se,0);this.dateStr=h};var z=h.TG_Date;z.getTimeUnitSerial=
function(c,j){var g=0;switch(j){case "ye":g=c.ye;break;case "mo":g=c.mo_num;break;case "da":g=c.rd;break;case "de":g=Math.floor(c.ye/10);break;case "ce":g=Math.floor(c.ye/100);break;case "thou":g=Math.floor(c.ye/1E3);break;case "tenthou":g=Math.floor(c.ye/1E4);break;case "hundredthou":g=Math.floor(c.ye/1E5);break;case "mill":g=Math.floor(c.ye/1E6);break;case "tenmill":g=Math.floor(c.ye/1E7);break;case "hundredmill":g=Math.floor(c.ye/1E8);break;case "bill":g=Math.floor(c.ye/1E9)}return g};z.getMonthDays=
function(c,j){return!0==z.isLeapYear(j)&&2==c?29:z.monthsDayNums[c]};z.twentyFourToTwelve=function(c){var j={};j.ye=c.ye;j.mo=c.mo;j.da=c.da;j.ho=c.ho;j.mi=c.mi;j.ampm="am";c.ho?12<=c.ho?(j.ampm="pm",j.ho=12<c.ho?c.ho-12:12):0==c.ho?(j.ho=12,j.ampm="am"):j.ho=c.ho:(j.ho=12,j.mi=0,j.ampm="am");return j};z.getMonthAdj=function(c,j){var g=z.getDateFromMonthNum(c);switch(g.mo){case 1:case 3:case 5:case 7:case 8:case 10:case 12:return g=Math.floor(j+3*(j/28)),{width:g,days:31};case 2:return!0==z.isLeapYear(g.ye)?
(g=Math.floor(j+j/28),{width:g,days:29}):{width:j,days:28};default:return g=Math.floor(j+2*(j/28)),{width:g,days:30}}};z.getDateFromMonthNum=function(c){var j=0;0<c?(j=c%12,0==j&&(j=12),c=Math.ceil(c/12)):(j=Math.abs(c)%12,j=12-j+1,13==j&&(j=1),c=-1*Math.ceil(Math.abs(c)/12));return{ye:c,mo:j}};z.getMonthWidth=function(c,j,g){j=t/28;var h;switch(c){case 1:case 3:case 5:case 7:case 8:case 10:case 12:h=3;break;case 4:case 6:case 9:case 11:h=2;break;case 2:h=!0==z.isLeapYear(yr)?1:0}return{width:Math.floor(g+
j*h),numDays:28+h}};z.getToday=function(){var c=new Date;return c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate()+" "+c.getHours()+":"+c.getMinutes()+":00"};z.getMonthFromRemDays=function(c,j){var g=0,h=g=0,g=z.isLeapYear(j)?1:0;31>=c?(h=1,g=c):31<c&&c<=59+g?(h=2,g=c-(31+g)):c>59+g&&c<=90+g?(h=3,g=c-(59+g)):c>90+g&&c<=120+g?(h=4,g=c-(90+g)):c>120+g&&c<=151+g?(h=5,g=c-(120+g)):c>151+g&&c<=181+g?(h=6,g=c-(151+g)):c>181+g&&c<=212+g?(h=7,g=c-(181+g)):c>212+g&&c<=243+g?(h=8,g=c-(212+g)):c>243+g&&c<=
273+g?(h=9,g=c-(243+g)):c>273+g&&c<=304+g?(h=10,g=c-(273+g)):c>304+g&&c<=334+g?(h=11,g=c-(304+g)):(h=12,g=c-(334+g));return{mo:h,da:g}};z.getDateFromRD=function(d){if(c[d])return c[d];for(var j=Math.floor(d),g=400*Math.floor(j/146097),h=j-146097*Math.floor(j/146097),n=1,r=g+1,f=r+400;r<=f;r++)365<h?(h-=365,z.isLeapYear(r)&&(h-=1),n++):r=f;g+=n;0==h&&(h=1);h=z.getMonthFromRemDays(h,g);n=1440*(d-j);j=Math.floor(n%60);n=Math.floor(n/60);z.isLeapYear(g)&&2==h.mo&&(h.da+=1);j=g+"-"+h.mo+"-"+h.da+" "+n+
":"+j+":00";return c[d]=j};z.getDateFromSec=function(c){if(n[c])return n[c];var j=z.getDateFromRD(c/86400);return n[c]=j};z.isLeapYear=function(c){return 0==c%400?!0:0==c%100?!1:0==c%4?!0:!1};z.getRataDie=function(c){var h=c.ye,g=c.mo;c=c.da;var n=0;if(r[h+"-"+g+"-"+c])return r[h+"-"+g+"-"+c];if(0<=h){0==h&&(h=1);var n=146097*Math.floor(h/400),A=parseInt,B;B=h-h%400;var f=h;if(j[B+"-"+f])B=j[B+"-"+f];else{for(var l=0,q=B;q<f;q++)l=z.isLeapYear(q)?l+366:l+365;B=j[B+"-"+f]=l}A=A(B);B=parseInt;var D;
switch(g){case 1:D=0;break;case 2:D=31;break;case 3:D=59;break;case 4:D=90;break;case 5:D=120;break;case 6:D=151;break;case 7:D=181;break;case 8:D=212;break;case 9:D=243;break;case 10:D=273;break;case 11:D=304;break;case 12:D=334}2<g&&z.isLeapYear(h)&&(D+=1);D=B(D);n=n+A+D+c-366}else 0>h&&(n=z.getBCRataDie({ye:h,mo:g,da:c}));return r[h+"-"+g+"-"+c]=n};z.getBCRataDie=function(c){var j=c.ye,g=c.mo;c=c.da;if(A[j+"-"+g+"-"+c])return A[j+"-"+g+"-"+c];0==g&&(g=1);0==c&&(c=1);var h=-1*(366*(Math.abs(j)-
1)+[0,335,306,275,245,214,184,153,122,92,61,31,0][g]+(z.monthsDayNums[g]-c+1));return A[j+"-"+g+"-"+c]=h};z.setCulture=function(c){jQuery.global.culture=jQuery.global.cultures[c];z.monthNames=B.merge([""],jQuery.global.culture.calendar.months.names);z.monthNamesAbbr=B.merge([""],jQuery.global.culture.calendar.months.namesAbbr);z.monthNamesLet=" J F M A M J J A S O N D".split(" ");z.monthsDayNums=[0,31,28,31,30,31,30,31,31,30,31,30,31,29];z.dayNames=jQuery.global.culture.calendar.days.names;z.dayNamesAbbr=
jQuery.global.culture.calendar.days.namesAbbr;z.dayNamesShort=jQuery.global.culture.calendar.days.namesShort;z.units="da mo ye de ce thou tenthou hundredthou mill tenmill hundredmill bill".split(" ");z.patterns=jQuery.global.culture.calendar.patterns};z.prototype={format:function(c,j){if(!0==j)switch(this.date_display.substr(0,2)){case "no":return"";case "ye":c="yyyy";break;case "mo":c="Y";break;case "da":c="D";break;case "ho":c="f";break;default:c="f"}return B.global.format(this.jsDate,c)}}})(timeglider);(function(h){var B=h.levelHeight=10,r=jQuery;h.TG_Org=function(){this.blocks=[];this.ids=[];this.vis=[];this.tree=[];var j=this;this.addBlock=function(c,h){c.right=c.left+c.width;c.bottom=c.top+c.height;c.tickScope=h;j.blocks.push(c)};this.getBorg=function(){return this};this.getBlocks=function(){return this.blocks};this.getHTML=function(n,z){if("sweep"==n){j.tree=[];for(var d=0;300>d;d++)j.tree[d]=[];this.vis=[]}this.blocks.sort(h);var w,g="",B="";b_htm=html="";b={};blength=this.blocks.length;for(var J=
title_adj=0;J<blength;J++)b=this.blocks[J],b.tickScope==n&&-1==r.inArray(b.id,this.vis)&&(this.vis.push(b.id),title_adj=0,b.html&&"<div"==b.html.substr(0,4)?(b_htm="<div style='left:"+b.left+"px' id='ev_"+b.id+"'"+b.html.substr(4),html+=b_htm):(b.image?("layout"==b.image.display_class&&(title_adj=b.image.height+4),g="<div class='timeglider-event-image-"+b.image.display_class+"'><img src='"+b.image.src+"'></div>"):g="",c(b,0),0<b.y_position&&(b.top=-1*b.y_position),10>b.fontsize?b.opacity=b.fontsize/
10:b.opacity=1,!0==b.span?(d="timeglider-event-spanning",w="<div class='timeglider-event-spanner' style='top:"+title_adj+"px;height:"+b.fontsize+"px;width:"+b.spanwidth+"px'></div>"):w=d="",B=b.icon?"<img class='timeglider-event-icon' src='"+b.icon+"' style='height:"+b.fontsize+"px;left:-"+(b.fontsize+2)+"px; top:"+title_adj+"px'>":"",html=Math.abs(b.top)>z-16?html+("<div class='timeglider-more-plus' style='left:"+b.left+"px; top:-"+(z-Math.floor(16/3))+"px'>+</div>"):html+("<div class='timeglider-timeline-event "+
d+"' id='ev_"+b.id+"' style='width:"+b.width+"px;height:"+b.height+"px;left:"+b.left+"px;opacity:"+b.opacity+";top:"+b.top+"px;font-size:"+b.fontsize+"px;'>"+B+g+w+"<div class='timeglider-event-title' style='top:"+title_adj+"px'>"+b.title+"</div></div>")));return html};var h=function(c,j){var d=j.importance,h=c.importance;return d<h?-1:d>h?1:0},c=function(h,r){var d=!1,w=j.tree,g=w[r],A=r+1,J=!1,K=2;bump_ht=B;if(void 0!=g){for(K=0;K<g.length;K++){a:{d=g[K];if(!(h.left>d.right||h.right<d.left))if(h.left>=
d.left&&h.left<=d.right||h.right>=d.left&&h.right<=d.right||h.right>=d.right&&h.left<=d.left||h.right<=d.right&&h.left>=d.left)if(h.bottom<=d.bottom&&h.bottom>=d.top||h.top<=d.bottom&&h.top>=d.top||h.top==d.bottom&&h.top==d.top){d=!0;break a}d=!1}if(!0==d){h.top-=bump_ht;h.bottom-=bump_ht;c(h,A);J=!0;break}}if(!1==J){h.top-=h.fontsize;g.push(h);K=Math.ceil(h.height/B);g=0;for(g=1;g<=K;g++)A=r+g,w[A].push(h)}}}}})(timeglider);(function(h){function B(h){function j(c,d){return function(){return d.apply(c,arguments)}}var d=new Image,r=h.id,g=d.src=h.src;d.onerror=j(d,function(){c.reportImageSize({id:h.id,src:g,error:!0})});d.onload=j(d,function(){c.reportImageSize({id:r,src:g,width:this.width,height:this.height})})}var r=h.TG_Date,j=jQuery,A={},c;h.TG_Timeline=Backbone.Model.extend({defaults:{title:"Untitled",events:[],legend:[]},_chewTimeline:function(n){c=n.mediator;A=c.options;var z={da:[],mo:[],ye:[],de:[],ce:[],thou:[],
tenthou:[],hundredthou:[],mill:[],tenmill:[],hundredmill:[],bill:[]},d=r.units;n.startSeconds=[];n.endSeconds=[];n.spans=[];n.hasImagesAbove=!1;n.color||(n.color="#333333");if(n.events){for(var w,g,N,J,K=n.events.length,f=0;f<K;f++){g=n.events[f];g.id?N=g.id:g.id=N="anon"+this.anonEventId++;w=g.date_display||g.date_limit||"da";g.date_display=w.toLowerCase().substr(0,2);g.startdateObj=new r(g.startdate,g.date_display);g.enddateObj=new r(g.enddate,g.date_display);g.icon=!g.icon||"none"===g.icon?"":
A.icon_folder+g.icon;g.titleWidth=h.getStringWidth(g.title);g.image&&(w=g.image_class||"layout","above"==g.image_class&&(n.hasImagesAbove=!0),g.image={id:g.id,src:g.image,display_class:w},B(g.image),c.imagesToSize++);n.startSeconds.push(g.startdateObj.sec);n.endSeconds.push(g.enddateObj.sec);g.enddateObj.sec>g.startdateObj.sec?(g.span=!0,n.spans.push({id:g.id,start:g.startdateObj.sec,end:g.enddateObj.sec})):g.span=!1;for(var l=d.length,q=0;q<l;q++)w=d[q],J=r.getTimeUnitSerial(g.startdateObj,w),void 0!==
z[w][J]?z[w][J].push(N):z[w][J]=[N];c.eventPool["ev_"+N]=g}d=j.merge(n.startSeconds,n.endSeconds);d=timeglider.getLowHigh(d);n.bounds={first:d.low,last:d.high}}if(0<n.legend.length){d=n.legend;for(g=0;g<d.length;g++);}n.display="expanded";n.dateHash=z;delete n.events;return n},initialize:function(c){c=this._chewTimeline(c);this.set(c)},validate:function(){}})})(timeglider);(function(h){var B=h.TG_Date,r="",j="",A={},c=jQuery,n={},z="",d,w;debug.trace=function(d,l){c("#"+l).text(d)};h.TG_TimelineView=function(f,l){var g=this;j=l;A=j.options;r="#"+f._id;z=f._id;this._views={PLACE:r,CONTAINER:r+" .timeglider-container",TIMELINE_MENU:r+" .timeglider-timeline-menu",TIMELINE_MENU_UL:r+" .timeglider-timeline-menu ul",TIMELINE_LIST_BT:r+" .timeglider-list-bt",SLIDER_CONTAINER:r+" .timeglider-slider-container",SLIDER:r+" .timeglider-slider",ZOOM_DISPLAY:r+" .timeglider-zoomlevel-display",
TRUCK:r+" .timeglider-truck",CENTERLINE:r+" .timeglider-centerline",TICKS:r+" .timeglider-ticks",HANDLE:r+" .timeglider-handle",FOOTER:r+" .timeglider-footer",FILTER_BT:r+" .timeglider-filter-bt",FILTER_BOX:r+" .timeglider-filter-box",TOOLS_BT:r+" .timeglider-tools-bt"};d=this._views.CONTAINER;w=this._views.TICKS;this._templates={};this._templates={test:"testola",event_modal:this.getEventModalTemplate(),event_modal_video:c.template(null,"<div class='tg-modal timeglider-ev-video-modal ui-widget-content' id='${id}_modal'><div class='close-button-remove'></div><iframe width = '100%' height='300' src='${video}'></iframe></div>"),
timeline_modal:c.template(null,"<div class='tg-modal timeglider-timeline-modal ui-widget-content' id='tl_${id}_modal'><div class='close-button-remove'></div><h4 id='title'>${title}</h4><p>{{html description}}</p></div>"),filter_modal:c.template(null,"<div class='tg-modal timeglider-menu-modal timeglider-filter-box timeglider-menu-hidden'><div class='close-button'></div><h3>filter</h3><div class='timeglider-menu-modal-content'><div class='timeglider-formline'>show: <input type='text' class='timeglider-filter-include'></div><div class='timeglider-formline'>hide: <input type='text' class='timeglider-filter-exclude'></div><ul><li class='timeglider-filter-clear'>clear</li><li class='timeglider-filter-apply'>apply</li></ul></div><div class='timeglider-menu-modal-point-right'></div>"),
timeline_list_modal:c.template(null,"<div class='timeglider-menu-modal timeglider-timeline-menu timeglider-menu-hidden'><div class='close-button'></div><h3>timelines</h3><div class='timeglider-menu-modal-content'><ul></ul></div><div class='timeglider-menu-modal-point-right'></div>"),legend_modal:c.template(null,"<div class='timeglider-menu-modal timeglider-legend timeglider-menu-hidden'  id='${id}_legend'><div class='timeglider-menu-modal-content'><ul id='${id}'>{{html legend_list}}</ul><div class='timeglider-close-button-small timeglider-legend-close'></div><div class='timeglider-legend-all'>all</div></div></div>")};
c(d).css("height",c(r).height());this.basicFontSize=A.basic_fontsize;!1==A.show_footer&&c(this._views.FOOTER).css("display","none");this.dragSpeed=0;this.dimensions=this.getWidgetDimensions();this.ticksHandleOffset=this.rightside=this.leftside=this.tickNum=0;this.timeoout_id=1;this.sliderActive=!1;this.ztop=1E3;this.filterBoxActivated=!1;this.buildSlider();this.setupFilter();c.subscribe("mediator.timelineDataLoaded",function(){c(".timeglider-loading").fadeOut(500)});c.subscribe("mediator.ticksOffsetChange",
function(){g.tickHangies();g.registerTitles();g.registerDragging()});c.subscribe("mediator.zoomLevelChange",function(){g.tickNum=0;g.leftside=0;var a=j.getZoomLevel();c(g._views.SLIDER).slider("value",g.invSliderVal(a));g.displayZoomLevel(a);g.castTicks("zoomLevelChange")});c.subscribe("mediator.ticksReadySignal",function(){!0===j.ticksReady&&g.freshTimelines()});c.subscribe("mediator.refreshSignal",function(){g.tickNum=0;g.leftside=0;g.castTicks("refreshSignal")});c.subscribe("mediator.ticksArrayChange",
function(){});c.subscribe("mediator.focusDateChange",function(){});c.subscribe("mediator.timelineListChangeSignal",function(){g.buildTimelineMenu()});c.subscribe("mediator.activeTimelinesChange",function(){c(g._views.TIMELINE_MENU_UL+" li").each(function(){var a=c(this).attr("id");-1!=c.inArray(a,j.activeTimelines)?c(this).addClass("activeTimeline"):c(this).removeClass("activeTimeline")})});c.subscribe("mediator.filterChange",function(){});this.setPanButton(c(".timeglider-pan-right"),-30);this.setPanButton(c(".timeglider-pan-left"),
30);c(this._views.TRUCK).dblclick(function(a){var c=a.pageX-g.dimensions.container.offset.left-g.dimensions.container.width/2,d=j.getZoomInfo().spp;a=j.getFocusDate().sec;c=new B(Math.floor(a+c*d));a=new B(a);debug.trace("DBLCLICK:"+a.mo+"-"+a.ye+" DBLCLICK:"+c.mo+"-"+c.ye,"note")}).bind("mousewheel",function(a,c){var d=Math.ceil(-1*3*c),f=j.getZoomLevel();j.setZoomLevel(f+d);return!1});c(w).draggable({axis:"x",drag:function(){j.setTicksOffset(c(this).position().left)},stop:function(){g.resetTicksHandle();
g.registerDragging()}}).delegate(d+" .timeglider-timeline-event","click",function(){var a=c(this).attr("id"),d=j.eventPool[a];if(d.click_callback){var a=d.click_callback.split("."),f=a[0];if(2==a.length)window[f][a[1]](d);else window[f](d)}else g.eventModal(a)}).delegate(".timeglider-timeline-event","mouseover",function(){var a=c(this).attr("id"),a=j.eventPool[a];debug.trace("hover, title:"+a.title,"note");g.eventHover(c(this),a)}).delegate(".timeglider-timeline-event","mouseout",function(){var a=
c(this).attr("id"),a=j.eventPool[a];debug.trace("hover, title:"+a.title,"note");g.eventUnHover(c(this),a)}).delegate(".timeglider-event-collapsed","hover",function(){var a=c(this).attr("id");debug.trace("collapsed, title:"+j.eventPool[a].title,"note")});c(d).delegate(".close-button-remove","click",function(){var a=c(this).parent().attr("id");c("#"+a).remove()});c(d).delegate(".full_modal_close","click",function(){c(".full_modal").remove()});c(d).delegate(".full_modal_scrim","click",function(){c(".full_modal").remove()});
c(d).delegate(".timeglider-more-plus","click",function(){j.zoom(-1)});c(d+" .timeglider-legend-close").live("click",function(){var a=c(d+" .timeglider-legend");a.fadeOut(300,function(){a.remove()})});c(d+" .timeglider-legend-all").live("click",function(){c(d+" .timeglider-legend li").each(function(){c(this).removeClass("tg-legend-icon-selected")});j.setFilters({origin:"legend",icon:"all"})});c.tmpl(g._templates.timeline_list_modal,{}).appendTo(d);c(g._views.TIMELINE_LIST_BT).click(function(){c(g._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden").position({my:"right bottom",
at:"right top",of:c(g._views.TIMELINE_LIST_BT),offset:"-8, -12"})});c(this._views.TIMELINE_MENU+" .close-button").live("click",function(){c(g._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden")});c(this._views.TOOLS_BT).click(function(){alert("I'm just a stand-in for the tools... ")});!0===j.options.show_centerline?c(this._views.CENTERLINE).css({height:g.dimensions.container.height,left:g.dimensions.container.centerx}):c(this._views.CENTERLINE).css({display:"none"});if(c.support.touch){c("#"+
z).addTouch();var h=document.getElementById(z);h.addEventListener("gesturestart",function(a){a.preventDefault();c("#output").append("<br>gesture zoom:"+j.getZoomLevel())},!1);h.addEventListener("gestureend",function(a){a.preventDefault();c("#output").append("<br>gesture end:"+j.getZoomLevel())},!1);h.addEventListener("gesturechange",function(a){a.preventDefault();c("#output").append("[l:r]")},!1)}};h.TG_TimelineView.prototype={getWidgetDimensions:function(){var f=c(d),l=f.width(),g=Math.floor(l/2)+
1,h=f.height(),a=Math.floor(h/2),e=f.position().left,f=f.offset(),j=!0==A.show_footer?c(this._views.FOOTER).height():0;return{container:{width:l,height:h,centerx:g,centery:a,left:e,offset:f},tick:{top:h-j-30},footer:{height:j}}},getEventModalTemplate:function(){var d=this,l=!1,g="",h=c.template(null,"<div class='tg-modal timeglider-ev-modal ui-widget-content' id='ev_${id}_modal'><div class='close-button-remove'></div><div class='startdate'>${startdate}</div><h4 id='title'>${title}</h4><p>{{html description}}</p><ul class='timeglider-ev-modal-links'>{{html links}}</ul></div>");
A.event_modal.href?c.ajax({url:A.event_modal.href,success:function(a){g=a.removeWhitespace();debug.log("stripped:"+g);d._templates.event_modal=l=c.template(null,g)},error:function(){d._templates.event_modal=l=h;debug.log("Custom event modal HTML file could not be found/loaded! Reverting to default.")}}):l=h;return l},scaleToImportance:function(c,d){return c/d},displayZoomLevel:function(d){0<d&&!0==A.display_zoom_level&&c(this._views.ZOOM_DISPLAY).text(d)},doSomething:function(){alert("FOO DO, viewer")},
setPanButton:function(d,l){var g=this;c(d).live("mousedown",function(){g.intervalMachine("pan",{type:"set",fn:g.pan,args:[l],intvl:33})}).live("mouseup",function(){g.intervalMachine("pan",{type:"clear",fn:g.pan,callback:"resetTicksHandle"})}).live("mouseout",function(){g.intervalMachine("pan",{type:"clear",fn:g.pan,callback:"resetTicksHandle"})})},intervalMachine:function(c,d){var g=this;if("clear"===d.type){if(clearInterval(n[c]),d.callback)g[d.callback]()}else n[c]=setInterval(function(){d.fn.apply(g,
d.args)},d.intvl)},invSliderVal:function(c){return Math.abs(c-101)},pan:function(d){d=d||20;$t=c(w);newPos=$t.position().left+d;$t.css({left:newPos});j.setTicksOffset(newPos)},registerTitles:function(){var f,g,h,j,a,e,n,r,w,k,s,z=c(d).offset().left;c(".timeglider-event-spanning").each(function(){f=c(this).offset().left-z;g=c(this).outerWidth();n=c(".timeglider-event-title",this);h=n.outerWidth()+5;j=n.siblings(".timeglider-event-spanner").outerWidth();j>h&&0>f&&Math.abs(f)<g-h&&n.css({marginLeft:-1*
f+5})});c(".tg-timeline-envelope").each(function(){r=c(this).offset().left-z;w=c(".titleBar",this);k=c(".titleBar .timeline-title",this);a=w.position().left;s=a+r;w.outerWidth();h=w.outerWidth();e=-1*s;0>s&&k.css({marginLeft:e+5})})},registerDragging:function(){var d=j.startSec,g=c(w).position().left,h=j.getZoomInfo().spp,d=new B(d-g*h);j.setFocusDate(d)},buildTimelineMenu:function(){var d,g=j.timelinePool,h=0;c(this._views.TIMELINE_MENU_UL+" li").remove();for(d in g){if(g.hasOwnProperty(d)){var n=
g[d];c(this._views.TIMELINE_MENU_UL).append("<li class = 'timelineList' id='"+d+"'>"+n.title+"</li>");c("li#"+d).click(function(){j.toggleTimeline(c(this).attr("id"))})}h++}},buildSlider:function(){var d=j.getZoomLevel();if(A.min_zoom==A.max_zoom)c(this._views.SLIDER_CONTAINER).css("display","none");else{!0==A.display_zoom_level&&c("<div>").appendTo(this._views.SLIDER_CONTAINER).addClass("timeglider-zoomlevel-display").html("&nbsp;");var g=this,d=g.invSliderVal(d),h=j.max_zoom,n=j.min_zoom;c(this._views.SLIDER).css("height",
3*(1+h-n)).slider({steps:100,handle:c(".knob"),animate:300,orientation:"vertical",min:g.invSliderVal(h),max:g.invSliderVal(n),value:d,start:function(){g.sliderActive=!0},stop:function(){g.sliderActive=!1},change:function(){},slide:function(a,c){j.setZoomLevel(g.invSliderVal(c.value))}})}},eventHover:function(d,g){var h=c(".timeglider-event-hover-info");"no"!=g.date_display&&h.position({my:"left bottom",at:"left top",of:d,offset:"1, -10",collision:"flip flip"}).text(g.startdateObj.format("D",!0));
d.addClass("tg-event-hovered")},eventUnHover:function(d){c(".timeglider-event-hover-info").css("left","-1000px");d.removeClass("tg-event-hovered")},setupFilter:function(){var d=this;c.tmpl(d._templates.filter_modal,{}).appendTo(d._views.CONTAINER);c(d._views.FILTER_BT).click(function(){var g=c(this),h=d._views.FILTER_BOX;if(!1==d.filterBoxActivated){d.filterBoxActivated=!0;var n=c(h+" .timeglider-filter-apply"),a=c(".timeglider-filter-box .close-button"),e=c(h+" .timeglider-filter-clear"),r="",w=
"";n.click(function(){r=c(h+" .timeglider-filter-include").val();w=c(h+" .timeglider-filter-exclude").val();j.setFilters({origin:"clude",include:r,exclude:w});c(h).toggleClass("timeglider-menu-shown")});a.click(function(){c(h).toggleClass("timeglider-menu-hidden")});e.click(function(){j.setFilters({origin:"clude",include:"",exclude:""});c(h+" .timeglider-filter-include").val("");c(h+" .timeglider-filter-exclude").val("");c(h).toggleClass("timeglider-menu-shown")})}c(h).toggleClass("timeglider-menu-hidden").css("z-index",
d.ztop++).position({my:"right bottom",at:"right top",of:g,offset:"-8, -12"})})},clearTicks:function(){this.tickNum=this.leftside=0;c(w).css("left",0).html("<div class='timeglider-handle'></div>")},castTicks:function(){this.clearTicks();j.getZoomLevel();var c=j.getFocusDate(),d=j.getZoomInfo().width,d=Math.ceil(this.dimensions.container.width/d)+4,g="l";j.setTicksReady(!1);this.addTick({type:"init",focus_date:c});for(c=1;c<=d;c+=1)this.addTick({type:g}),g="l"==g?"r":"l";j.setTicksReady(!0)},addTick:function(d){var g=
0,h=0,n=h=0,a=0,e=0,r="",e={},n={},z={},x={},e={},z=j.getZoomInfo().unit,x=j.getZoomInfo().width,a=j.getFocusDate(),n=parseInt(this.dimensions.tick.top),a=j.addToTicksArray({type:d.type,unit:z},a),k="",s=0,r="";"mo"==z&&(e=B.getMonthAdj(a,x),x=e.width,g=e.days);this.tickNum++;"init"==d.type?(e=this.tickOffsetFromDate(j.getZoomInfo(),j.getFocusDate(),x),this.leftside=h=Math.ceil(this.dimensions.container.centerx+e),this.rightside=h+x):"l"==d.type?this.leftside=h=Math.floor(this.leftside-x):"r"==d.type&&
(h=Math.floor(this.rightside),this.rightside+=x);j.getTickBySerial(a).width=x;j.getTickBySerial(a).left=h;r=this._views.PLACE+"_"+z+"_"+a+"-"+this.tickNum;e=c("<div class='timeglider-tick' id='"+r+"'><div class='timeglider-tick-label' id='label'></div></div>").appendTo(w);e.css({width:x,left:h,top:n});n=this.getTickMarksInfo({unit:z,width:x});n=g||n.tperu;h=x/n;if(5<h){d=Raphael(r,x,30);for(var y="",g=0;g<n;++g)r=g*h,y+="M"+r+" 20 L"+r+" 30","da"==z&&16<h&&(r=this.getHourLabelFromHour(s,h),k+="<div class='timeglider-tick-hour-label' style='width:"+
(h-4)+"px'>"+r+"</div>",s++);d.path(y).attr({stroke:"#333","stroke-width":1})}"da"==z&&32<h&&e.append("<div style='position:absolute;top:14px;left:0'>"+k+"</div>");z={unit:z,width:x,serial:a};x=this.getDateLabelForTick(z);e.children("#label").text(x);return z},getHourLabelFromHour:function(c,d){var g="",g=12<c?c-12:c;0==g&&(g=12);return g+(60<d?":00":"")+(11<c?" pm":" am")},getTickMarksInfo:function(c){switch(c.unit){case "da":c=24;break;case "mo":c=30;break;case "ye":c=12;break;default:c=10}return{tperu:c}},
getDateLabelForTick:function(c){var d=c.serial,g=c.width;switch(c.unit){case "bill":return 0==d?"1":0<d?d+" billion":d+" b.y. bce";case "hundredmill":return 0==d?"1":0<d?d+"00 million":d+"00 m.y. bce";case "tenmill":return 0==d?"1":0<d?d+"0 million":d+"0 m.y. bce";case "mill":return 0==d?"1":0<d?d+" million":d+" m.y. bce";case "hundredthou":return 0==d?"1":0<d?d+"00,000":d+"00,000 bce";case "tenthou":return 0==d?"1":0<d?d+"0,000":d+"0,000 bce";case "thou":return 0==d?"1("+d+")":0<d?d+"000":d+"000 bce";
case "ce":return 0==d?"1("+d+")":0<d?d+"00":d+"00 bce";case "de":return 10*(d-1)+"s";case "ye":return d;case "mo":return c=B.getDateFromMonthNum(d),120>g?B.monthNamesAbbr[c.mo]+" "+c.ye:B.monthNames[c.mo]+", "+c.ye;case "da":return c=new B(B.getDateFromRD(d)),120>g?B.monthNamesAbbr[c.mo]+" "+c.da+", "+c.ye:B.monthNames[c.mo]+" "+c.da+", "+c.ye;default:return c.unit+":"+d+":"+g}},tickHangies:function(){var d=c(w).position().left,g=this.rightside+d-this.dimensions.container.width;-100<this.leftside+
d?(d=this.addTick({type:"l"}),this.appendTimelines(d)):100>g&&(d=this.addTick({type:"r"}),this.appendTimelines(d))},tickOffsetFromDate:function(c,d,g){switch(c.unit){case "da":d=d.ho/24+d.mi/1440;g*=d;break;case "mo":c=B.getMonthDays(d.mo,d.ye);d=(d.da-1)/c+d.ho/(24*c)+d.mi/(1440*c);g*=d;break;case "ye":d=(30*(d.mo-1)+d.da)/365;g*=d;break;case "de":d=d.ye%10/10+d.mo/120;g*=d;break;case "ce":d=d.ye%100/100+d.mo/1200;g*=d;break;case "thou":d=d.ye%1E3/1E3;g*=d;break;case "tenthou":d=d.ye%1E4/1E4;g*=
d;break;case "hundredthou":d=d.ye%1E5/1E5;g*=d;break;default:g=0}return-1*g},resetTicksHandle:function(){c(this._views.HANDLE).offset({left:c(d).offset().left})},easeOutTicks:function(){5<Math.abs(this.dragSpeed)&&debug.trace("ticks stopped!","note")},getTimelineEventsByTick:function(c){var d=c.tick.unit,g=c.tick.serial;c=c.timeline.dateHash;return c[d][g]&&0<c[d][g].length?c[d][g]:0},setTimelineProp:function(c,d,g){j.timelinePool[c][d]=g},getTimelineProp:function(c,d){return j.timelinePool[c][d]},
passesFilters:function(d,g){var h=!0,n="",a=[],e,n="",a=[];if(g<d.low_threshold||g>d.high_threshold)return!1;if(n=j.filters.include){a=n.split(",");h=!1;for(e=0;e<a.length;e++)n=RegExp(c.trim(a[e]),"i"),d.title.match(n)&&(h=!0)}if(n=j.filters.exclude){a=n.split(",");for(e=0;e<a.length;e++)n=RegExp(c.trim(a[e]),"i"),d.title.match(n)&&(h=!1)}n=d.icon;0<j.filters.legend.length&&-1==c.inArray(n,j.filters.legend)&&(h=!1);return h},freshTimelines:function(){var f,g,h,n,a=j.activeTimelines,e=j.ticksArray,
r="",z,x=this;g="";var k=x.dimensions.container.centerx,s=x.dimensions.container.width,y=j.getFocusDate().sec,u=j.getZoomInfo().spp;j.getZoomInfo();g=[];var A=[],s=y-Math.floor(u*(s/2));g="";for(var B,C=0,K=x.dimensions.container.height,J=C=0;J<a.length;J++){f=j.timelinePool[a[J]];B=f.display;C=f.top?parseInt(f.top.replace("px","")):K-120;g=0<f.legend.length?"<span class='tg-timeline-legend-bt'>legend</span>":"";$tl=c("<div class='tg-timeline-envelope' id='"+f.id+"'><div class='titleBar'><div class='timeline-title'>"+
f.title+"<div class='tg-timeline-env-buttons'><span class='timeline-info'>info</span>"+g+"</div></div></div></div>").appendTo(w);$tl.draggable({axis:"y",handle:".titleBar",stop:function(){x.setTimelineProp(f.id,"top",c(this).css("top"));j.refresh()}}).css("top",C);g=$tl.height();c(d+" .tg-timeline-envelope#"+f.id+" .titleBar .expand-collapse").click(function(){x.expandCollapseTimeline(f.id)});c(d+" .tg-timeline-envelope#"+f.id+" .titleBar .timeline-info").click(function(){x.timelineModal(f.id)});
c(d+" .tg-timeline-envelope#"+f.id+" .titleBar .tg-timeline-legend-bt").click(function(){x.legendModal(f.id)});z=$tl.children(".titleBar");h=k+(f.bounds.first-y)/u;n=k+(f.bounds.last-y)/u;z.css({top:g,left:h,width:n-h});"expanded"==B&&(f.borg=r=new timeglider.TG_Org);for(h=0;h<e.length;h++)g=this.getTimelineEventsByTick({tick:e[h],timeline:f}),c.merge(A,g);for(h=0;h<f.spans.length;h++)g=f.spans[h],g.start<s&&g.end>s&&-1==c.inArray(g.id,A)&&A.unshift(g.id);g=this.compileTickEventsAsHtml(f,A,0,"sweep");
C=f.hasImagesAbove?C-56:C;"expanded"==B&&(g=r.getHTML("sweep",C),f.borg=r.getBorg());"undefined"!=g&&$tl.append(g);this.registerEventImages($tl)}x.registerTitles()},appendTimelines:function(d){for(var g=j.activeTimelines,h,n="",a=0;a<g.length;a++)h=j.timelinePool[g[a]],idArr=this.getTimelineEventsByTick({tick:d,timeline:h}),n=this.compileTickEventsAsHtml(h,idArr,d.serial,"append"),"expanded"==h.display&&(n=h.borg.getHTML(d.serial,h.top)),h=c(".tg-timeline-envelope#"+h.id).append(n),this.registerEventImages(h)},
compileTickEventsAsHtml:function(c,d,g,h){var a;a=0;var e=this.dimensions.container.centerx,n=c.display,r=$tl.height();stuff="";foSec=j.startSec;spp=j.getZoomInfo().spp;zl=j.getZoomInfo().level;buffer=20;borg=c.borg;block_arg="sweep";"append"==h&&(block_arg=g);for(g=0;g<d.length;g++)ev=j.eventPool["ev_"+d[g]],!0===this.passesFilters(ev,zl)&&(a=e+(ev.startdateObj.sec-foSec)/spp,"expanded"==n?(impq=!1!==c.size_importance?this.scaleToImportance(ev.importance,zl):1,ev.width=ev.titleWidth*impq+buffer,
ev.fontsize=this.basicFontSize*impq,ev.left=a,ev.spanwidth=0,!0==ev.span&&(ev.spanwidth=(ev.enddateObj.sec-ev.startdateObj.sec)/spp,ev.spanwidth>ev.width&&(ev.width=ev.spanwidth)),a=0,ev.image&&"layout"===ev.image.display_class&&(a=ev.image.height+2,ev.width=ev.image.width>ev.width?ev.image.width:ev.width),ev.height=Math.ceil(ev.fontsize)+a,ev.top=r-ev.height,borg.addBlock(ev,block_arg)):"collapsed"==n&&(stuff+="<div id='ev_"+ev.id+"' class='timeglider-event-collapsed' style='top:"+(r-2)+"px;left:"+
a+"px'></div>"));return"collapsed"==n?stuff:""},registerEventImages:function(f){c(".timeglider-event-image-bar").each(function(){c(this).position({my:"top",at:"bottom",of:f,offset:"0, 0"}).css("left",0)});c(".timeglider-event-image-above").each(function(){c(this).position({my:"top",at:"top",of:c(d),offset:"0, 12"}).css("left",0)})},expandCollapseTimeline:function(c){c=j.timelinePool[c];c.display="expanded"==c.display?"collapsed":"expanded";j.refresh()},timelineModal:function(f){c("#tl_"+f+"_modal").remove();
var g=j.timelinePool[f];c.tmpl(this._templates.timeline_modal,{title:g.title,description:g.description,id:f}).appendTo(d).css("z-index",this.ztop++).position({my:"left top",at:"left top",of:this._views.CONTAINER,offset:"32, 32",collision:"fit fit"}).draggable({stack:".timeglider-modal"})},createEventLinksMenu:function(c,d){if(!c)return"";var g="",h=0,a="",e="";"full"==d&&(g+="<li><h4>links</h4></li>");if("string"==typeof c)g="<li><a href='"+c+"' target='_blank'>link</a></li>";else if("object"==typeof c)for(h=
0;h<c.length;h++)a=c[h].url,e=c[h].label,g+="<li><a href='"+a+"' target='_blank'>"+e+"</a></li>";return g},eventModal:function(f){c("#ev_"+f+"_modal").remove();var g=this,h=A.event_modal.type,n=c("#"+f),a=g._templates.event_modal;ev=j.eventPool[f];ev_img=ev.image&&ev.image.src?"<img src='"+ev.image.src+"'>":"";ev_img_src=ev.image&&ev.image.src?ev.image.src:"";links=this.createEventLinksMenu(ev.link,h);ev_descr="default"==h?ev_img+ev.description:ev.description;templ_obj={title:ev.title,description:ev_descr,
id:f,startdate:ev.startdateObj.format("D",!0),links:links,image:ev_img_src,video:ev.video};ev.video&&(a=g._templates.event_modal_video,templ_obj.video=ev.video);f=c.tmpl(a,templ_obj);switch(h){case "full":f.appendTo(d).css({"z-index":g.ztop++}).position({my:"left top",at:"left top",of:d,offset:"0, 0",collision:"none none"});f.children(".full_modal_panel").css({width:g.dimensions.container.width-64+"px",height:g.dimensions.container.height-64+"px"});break;default:f.appendTo(w).css("z-index",g.ztop++).position({my:"right center",
at:"left center",of:n,offset:"-12, -1",collision:"flip fit"}).draggable().hover(function(){c(this).css("z-index",g.ztop++)})}},legendModal:function(f){var g=j.timelinePool[f].legend,h,n,a,e="";for(h=0;h<g.length;h++)n=A.icon_folder+g[h].icon,a=g[h].title,e+="<li><img src='"+n+"'>"+a+"</li>";f={id:f,legend_list:e};c(d+" .timeglider-legend").remove();c.tmpl(this._templates.legend_modal,f).appendTo(d).css("z-index",this.ztop++).toggleClass("timeglider-menu-hidden").position({my:"left top",at:"left top",
of:d,offset:"16, -4",collision:"none none"});c(d+" .timeglider-legend li").click(function(){c(this).parent().attr("id");var a=c(this).children("img").attr("src");c(this).toggleClass("tg-legend-icon-selected");j.setFilters({origin:"legend",icon:a})})},parseHTMLTable:function(d){var g={},h=+new Date,j=[];c("#"+d).find("tr").each(function(a){var d=c(this).children(),f;0===a?j=d.map(function(){return c(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get():(f={},d.each(function(a){f[j[a]]=c(this).text()}),
g["prefix"+h++]=f)});return g}};h.zoomTree=[{},{unit:"da",width:35E3,level:1,label:"5 hours"},{unit:"da",width:17600,level:2,label:"7 hours"},{unit:"da",width:8800,level:3,label:"10 hours"},{unit:"da",width:4400,level:4,label:"12 hours"},{unit:"da",width:2200,level:5,label:"14 hours"},{unit:"da",width:1100,level:6,label:"17 hours"},{unit:"da",width:550,level:7,label:"22 hours"},{unit:"da",width:432,level:8,label:"1 DAY"},{unit:"da",width:343,level:9,label:"1.5 days"},{unit:"da",width:272,level:10,
label:"2 days"},{unit:"da",width:216,level:11,label:"2.5 days"},{unit:"da",width:171,level:12,label:"3 days"},{unit:"da",width:136,level:13,label:"3.5 days"},{unit:"da",width:108,level:14,label:"4 days"},{unit:"mo",width:2509,level:15,label:"6 days"},{unit:"mo",width:1945,level:16,label:"1 WEEK"},{unit:"mo",width:1508,level:17,label:"10 days"},{unit:"mo",width:1169,level:18,label:"2 weeks"},{unit:"mo",width:913,level:19,label:"2.5 weeks"},{unit:"mo",width:719,level:20,label:"3 weeks"},{unit:"mo",
width:566,level:21,label:"3.5 weeks"},{unit:"mo",width:453,level:22,label:"1 MONTH"},{unit:"mo",width:362,level:23,label:"5.5 weeks"},{unit:"mo",width:290,level:24,label:"7 weeks"},{unit:"mo",width:232,level:25,label:"2 months"},{unit:"mo",width:186,level:26,label:"2.5 months"},{unit:"mo",width:148,level:27,label:"3 months"},{unit:"mo",width:119,level:28,label:"4 months"},{unit:"mo",width:95,level:29,label:"5 months"},{unit:"mo",width:76,level:30,label:"6 months"},{unit:"ye",width:723,level:31,label:"9 months"},
{unit:"ye",width:573,level:32,label:"1 YEAR"},{unit:"ye",width:455,level:33,label:"1.25 years"},{unit:"ye",width:361,level:34,label:"1.5 years"},{unit:"ye",width:286,level:35,label:"2 years"},{unit:"ye",width:227,level:36,label:"2.5 years"},{unit:"ye",width:179,level:37,label:"3 years"},{unit:"ye",width:142,level:38,label:"4 years"},{unit:"ye",width:113,level:39,label:"5 years"},{unit:"ye",width:89,level:40,label:"6 years"},{unit:"de",width:705,level:41,label:"8 years"},{unit:"de",width:559,level:42,
label:"10 years"},{unit:"de",width:443,level:43,label:"13 years"},{unit:"de",width:302,level:44,label:"16 years"},{unit:"de",width:240,level:45,label:"20 years"},{unit:"de",width:190,level:46,label:"25 years"},{unit:"de",width:150,level:47,label:"30 years"},{unit:"de",width:120,level:48,label:"40 years"},{unit:"de",width:95,level:49,label:"50 years"},{unit:"de",width:76,level:50,label:"65 years"},{unit:"ce",width:600,level:51,label:"80 years"},{unit:"ce",width:480,level:52,label:"100 years"},{unit:"ce",
width:381,level:53,label:"130 years"},{unit:"ce",width:302,level:54,label:"160 years"},{unit:"ce",width:240,level:55,label:"200 years"},{unit:"ce",width:190,level:56,label:"250 years"},{unit:"ce",width:150,level:57,label:"300 years"},{unit:"ce",width:120,level:58,label:"400 years"},{unit:"ce",width:95,level:59,label:"500 years"},{unit:"ce",width:76,level:60,label:"600 years"},{unit:"thou",width:603,level:61,label:"1000 years"},{unit:"thou",width:478,level:62,label:"1200 years"},{unit:"thou",width:379,
level:63,label:"1800 years"},{unit:"thou",width:301,level:64,label:"160 years"},{unit:"thou",width:239,level:65,label:"xxx years"},{unit:"thou",width:190,level:66,label:"xxx years"},{unit:"thou",width:150,level:67,label:"xxx years"},{unit:"thou",width:120,level:68,label:"xxx years"},{unit:"thou",width:95,level:69,label:"8,000 years"},{unit:"thou",width:76,level:70,label:"10,000 years"},{unit:"tenthou",width:603,level:71,label:"15,000 years"},{unit:"tenthou",width:358,level:72,label:"20,000 years"},
{unit:"tenthou",width:213,level:73,label:"30,000 years"},{unit:"tenthou",width:126,level:74,label:"60,000 years"},{unit:"tenthou",width:76,level:75,label:"100,000 years"},{unit:"hundredthou",width:603,level:76,label:"180,000 years"},{unit:"hundredthou",width:358,level:77,label:"300,000 years"},{unit:"hundredthou",width:213,level:78,label:"500,000 years"},{unit:"hundredthou",width:126,level:79,label:"800,000 years"},{unit:"hundredthou",width:76,level:80,label:"1 million years"},{unit:"mill",width:603,
level:81,label:"1.2 million years"},{unit:"mill",width:358,level:82,label:"2 million years"},{unit:"mill",width:213,level:83,label:"3 million years"},{unit:"mill",width:126,level:84,label:"5 million years"},{unit:"mill",width:76,level:85,label:"10 million years"},{unit:"tenmill",width:603,level:86,label:"15 million years"},{unit:"tenmill",width:358,level:87,label:"30 million years"},{unit:"tenmill",width:213,level:88,label:"50 million years"},{unit:"tenmill",width:126,level:89,label:"80 million years"},
{unit:"tenmill",width:76,level:90,label:"100 million years"},{unit:"hundredmill",width:603,level:91,label:"120 million years"},{unit:"hundredmill",width:358,level:92,label:"200 million years"},{unit:"hundredmill",width:213,level:93,label:"300 million years"},{unit:"hundredmill",width:126,level:94,label:"500 million years"},{unit:"hundredmill",width:76,level:95,label:"1 billion years"},{unit:"bill",width:603,level:96,label:"15 million years"},{unit:"bill",width:358,level:97,label:"30 million years"},
{unit:"bill",width:213,level:98,label:"50 million years"},{unit:"bill",width:126,level:99,label:"80 million years"},{unit:"bill",width:76,level:100,label:"100 billion years"}];for(var g=h.zoomTree,N=1;N<g.length;N++){var J=g[N],K=0;switch(J.unit){case "da":K=86400;break;case "mo":K=2419200;break;case "ye":K=31536E3;break;case "de":K=31536E4;break;case "ce":K=31536E5;break;case "thou":K=31536E6;break;case "tenthou":K=31536E7;break;case "hundredthou":K=31536E8;break;case "mill":K=31536E9;break;case "tenmill":K=
31536E10;break;case "hundredmill":K=31536E11;break;case "bill":K=31536E12}J.spp=K/parseInt(J.width)}h.calculateSecPerPx=void 0;h.getStringWidth=function(d){if(d)return c("#timeglider-measure-span").html(d).width()};String.prototype.removeWhitespace=function(){return this.replace(RegExp("\\n","g"),"")}})(timeglider);(function(h){var B={},r=h.TG_Date,j={},A=jQuery;h.TimelineCollection=Backbone.Collection.extend({model:timeglider.TG_Timeline});h.TG_Mediator=function(c){this.options=j=c;this._focusDate={};this._zoomInfo={};this._zoomLevel=1;this.ticksReady=!1;this.ticksArray=[];this.startSec=0;this.activeTimelines=[];this.max_zoom=j.max_zoom;this.min_zoom=j.min_zoom;this.fixed_zoom=this.max_zoom==this.min_zoom?!0:!1;this.gesturing=!1;this.gestureStartScale=this.gestureStartZoom=0;this.filters={include:"",exclude:"",
legend:[]};this.eventPool=[];this.timelinePool={};this.imagesToSize=this.imagesSized=0;this.timelineDataLoaded=!1;this.foo="bark";this.initial_timeline_id=j.initial_timeline_id||"";this.sole_timeline_id="";j.max_zoom===j.min_zoom&&(this.fixed_zoom=j.min_zoom);B=this};h.TG_Mediator.prototype={gotoDateZoom:function(c,h){var j=new r(c),d=!1;this.setFocusDate(j);h&&(d=this.setZoomLevel(h));(!h||!1==d)&&this.refresh()},zoom:function(c){c=this.getZoomLevel()+parseInt(c);this.setZoomLevel(c)},loadTimelineData:function(c){var h=
this;c?"object"===typeof c?h.parseData(c):"#"==c.substr(0,1)?(c=[h.getTableTimelineData(c)],h.parseData(c)):A.getJSON(c,function(c){h.parseData(c)}):(this.timelineDataLoaded=!0,this.setZoomLevel(Math.floor((this.max_zoom+this.min_zoom)/2)),this.tryLoading())},getTableTimelineData:function(c){var h={},j=0,d=[],w,g,B="",J=A(c);h.id=c.substr(1);h.title=J.attr("title")||"untitled";h.description=J.attr("description")||"";h.focus_date=J.attr("focus_date")||r.getToday;h.initial_zoom=J.attr("initial_zoom")||
20;h.events=[];J.find("tr").each(function(c){var f=A(this).children(),l;0===c?d=f.map(function(){return A(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get():(l={},f.each(function(c){w=d[c];g=A(this).text();l[w]=g}),B="ev_"+j++,l.id=B,h.events.push(l))});J.css("display","none");return h},parseData:function(c){for(var h=0,j=c.length,d={},d={},r=0;r<j;r++)d=c[r],d.mediator=this,d=(new timeglider.TG_Timeline(d)).toJSON(),0<d.id.length&&(h++,this.swallowTimeline(d));0===h?alert("ERROR loading data: Check JSON with jsonLint"):
(this.timelineDataLoaded=!0,this.tryLoading())},tryLoading:function(){var c=!0==this.timelineDataLoaded;this.imagesSized==this.imagesToSize&&c&&(this.setInitialTimelines(),A.publish("mediator.timelineDataLoaded"))},swallowTimeline:function(c){this.sole_timeline_id=c.id;this.timelinePool[c.id]=c;A.publish("mediator.timelineListChangeSignal")},setInitialTimelines:function(){var c=this.initial_timeline_id||this.sole_timeline_id;c&&setTimeout(function(){B.toggleTimeline(c)},1E3)},refresh:function(){this.startSec=
this._focusDate.sec;A.publish("mediator.refreshSignal")},setTicksReady:function(c){this.ticksReady=c;!0===c&&A.publish("mediator.ticksReadySignal")},getFocusDate:function(){return this._focusDate},setFocusDate:function(c){c!=this._focusDate&&(this._focusDate=c)},getZoomLevel:function(){return parseInt(this._zoomLevel)},setZoomLevel:function(c){return c<=this.max_zoom&&c>=this.min_zoom&&(this.startSec=this._focusDate.sec,c!=this._zoomLevel)?(this._zoomLevel=c,this._zoomInfo=timeglider.zoomTree[c],
A.publish("mediator.zoomLevelChange"),!0):!1},getZoomInfo:function(){return this._zoomInfo},setFilters:function(c){switch(c.origin){case "clude":this.filters.include=c.include;this.filters.exclude=c.exclude;break;case "legend":var h=c.icon;"all"==h?(this.filters.legend=[],A.publish("mediator.legendAll")):-1==A.inArray(h,this.filters.legend)?this.filters.legend.push(h):(c=[],c=A.grep(this.filters.legend,function(c){return c!=h}),this.filters.legend=c)}A.publish("mediator.filtersChange");this.refresh()},
getTicksOffset:function(){return this._ticksOffset},setTicksOffset:function(c){this._ticksOffset=c;A.publish("mediator.ticksOffsetChange")},getTickBySerial:function(c){for(var h=this.ticksArray,j=h.length,d=0;d<j;d++){var r=h[d];if(r.serial==c)return r}return!1},addToTicksArray:function(c,h){"init"==c.type?(c.serial=r.getTimeUnitSerial(h,c.unit),this.ticksArray=[c]):"l"==c.type?(c.serial=this.ticksArray[0].serial-1,this.ticksArray.unshift(c)):(c.serial=this.ticksArray[this.ticksArray.length-1].serial+
1,this.ticksArray.push(c));A.publish("mediator.ticksArrayChange");return c.serial},toggleTimeline:function(c){var h=this.timelinePool[c],j=A.inArray(c,this.activeTimelines);-1==j?(this.activeTimelines.push(c),c=new r(h.focus_date),this.setFocusDate(c),this.setZoomLevel(h.initial_zoom)):this.activeTimelines.splice(j,1);this.refresh();A.publish("mediator.activeTimelinesChange")},reportImageSize:function(c){var h=B.eventPool["ev_"+c.id];c.error?(h.image={},debug.log("WHOOPS: MISSING IMAGE: "+c.src)):
(h.image.width=c.width,h.image.height=c.height);this.imagesSized++;this.imagesSized==this.imagesToSize&&this.tryLoading()}};h.getLowHigh=function(c){var h,j,d=parseFloat(c[0]),r=d;for(h=0;h<c.length;h++)j=parseFloat(c[h]),j<r&&(r=j),j>d&&(d=j);return{high:d,low:r}};h.validateOptions=function(c){this.optionsMaster={initial_focus:{type:"date"},editor:{type:"string"},backgroundColor:{type:"color"},backgroundImage:{type:"color"},min_zoom:{type:"number",min:1,max:100},max_zoom:{type:"number",min:1,max:100},
initial_zoom:{type:"number",min:1,max:100},show_centerline:{type:"boolean"},display_zoom_level:{type:"boolean"},data_source:{type:"url"},basic_fontsize:{type:"number",min:9,max:100},mouse_wheel:{type:"string",possible:["zoom","pan"]},initial_timeline_id:{type:"string"},icon_folder:{type:"string"},show_footer:{type:"boolean"},display_zoom_level:{type:"boolean"},event_modal:{type:"object"}};var h=this,j="";A.each(c,function(c,r){if(h.optionsMaster[c])switch(h.optionsMaster[c].type){case "string":"string"!=
typeof r&&(j+=c+" needs to be a string.\n");h.optionsMaster[c].possible&&-1==A.inArray(r,h.optionsMaster[c].possible)&&(j+=c+" must be: "+h.optionsMaster[c].possible.join(" or "));break;case "number":"number"!=typeof r&&(j+=r+" needs to be a number.\n");h.optionsMaster[c].min&&r<h.optionsMaster[c].min&&(j+=c+" must be greater than or equal to "+h.optionsMaster[c].min+"\n");h.optionsMaster[c].max&&r>h.optionsMaster[c].max&&(j+=c+" must be less than or equal to "+h.optionsMaster[c].max+"\n");break;
case "boolean":"boolean"!=typeof r&&(j+=r+" needs to be a number.\n")}});return j}})(timeglider);(function(h){var B,r,j=timeglider,A=timeglider.TG_Date;h.widget("timeglider.timeline",{options:{initial_focus:j.TG_Date.getToday(),editor:"none",min_zoom:1,max_zoom:100,show_centerline:!0,data_source:"",culture:"en",basic_fontsize:12,mouse_wheel:"zoom",initial_timeline_id:"",icon_folder:"js/timeglider/icons/",show_footer:!0,display_zoom_level:!0,event_modal:{href:"",type:"default"}},_create:function(){this._id=h(this.element).attr("id");this.element.html("<div class='timeglider-container'><div class='timeglider-loading'>loading</div><div class='timeglider-centerline'></div><div class='timeglider-truck' id='tg-truck'><div class='timeglider-ticks'><div class='timeglider-handle'></div></div></div><div class='timeglider-slider-container'><div class='timeglider-slider'></div><div class='timeglider-pan-buttons'><div class='timeglider-pan-left'></div><div class='timeglider-pan-right'></div></div></div><div class='timeglider-footer'><div class='timeglider-logo'></div><div class='timeglider-footer-button timeglider-filter-bt'></div><div class='timeglider-footer-button timeglider-list-bt'></div></div><div class='timeglider-event-hover-info'></div></div><span id='timeglider-measure-span'></span>")},
_init:function(){var c=timeglider.validateOptions(this.options);""==c?(j.TG_Date.setCulture(this.options.culture),r=new j.TG_Mediator(this.options),B=new j.TG_TimelineView(this,r),r.setFocusDate(new A(this.options.initial_focus)),r.loadTimelineData(this.options.data_source)):alert("Rats. There's a problem with your widget settings:"+c)},goTo:function(c,h){r.gotoDateZoom(c,h)},zoom:function(c){switch(c){case "in":c=-1;break;case "out":c=1}if(99<c||-99>c)return!1;r.zoom(c)},panButton:function(c,h){var j=
0;switch(h){case "left":j=30;break;case "right":j=-30;break;default:j=h}B.setPanButton(c,j)},destroy:function(){h.Widget.prototype.destroy.apply(this,arguments);h(this.element).html("")}})})(jQuery);
